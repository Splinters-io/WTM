<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Threat Model Selector & RACI Matrix</title>
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Dark mode defaults */
            --bg-color: #121212;
            --surface-1: #1E1E1E;
            --surface-2: #272727;
            --text-primary: #E0E0E0;
            --text-secondary: #BBBBBB;
            --accent-primary: #4D94FF;
            --accent-secondary: #6B8CFF;
            --accent-hover: #638FE8;
            --border-color: #333333;
            --header-bg: #1a2a47;
            --success: #4CAF50;
            --warning: #FF9800;
            --error: #F44336;
            
            /* Text size variables */
            --text-size-factor: 1;
            --text-size-small: 0.9;
            --text-size-medium: 1;
            --text-size-large: 1.2;
        }

        [data-theme="light"] {
            --bg-color: #ffffff;
            --surface-1: #f8f9fa;
            --surface-2: #e9ecef;
            --text-primary: #212529;
            --text-secondary: #6c757d;
            --accent-primary: #0066CC;
            --accent-secondary: #4285F4;
            --accent-hover: #0052A3;
            --border-color: #dee2e6;
            --header-bg: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            --success: #28a745;
            --warning: #fd7e14;
            --error: #dc3545;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            line-height: 1.65;
            transition: all 0.3s ease;
            font-size: calc(1rem * var(--text-size-factor));
        }

        [data-theme="dark"] body {
            font-weight: 350;
        }

        [data-theme="light"] body {
            font-weight: 400;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            background: var(--header-bg);
            color: var(--text-primary);
            text-align: left;
            padding: 40px 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
            transition: all 0.5s ease;
            min-height: 300px;
        }
        
        header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23ffffff' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
            opacity: 0.7;
            z-index: 0;
        }

        .mega-title {
            margin-bottom: 30px;
            margin-top: 10px;
            position: relative;
            z-index: 1;
        }
        
        .mega-title h1 {
            display: flex;
            flex-direction: column;
            line-height: 0.9;
            margin-bottom: 30px;
        }
        
        .title-word {
            font-size: 5.5rem;
            font-weight: 900;
            color: white;
            text-transform: uppercase;
            letter-spacing: -0.02em;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.3);
            margin-bottom: 8px;
            transition: all 0.5s ease-out;
            transform-origin: left center;
            position: relative;
            left: 0;
            line-height: 1;
        }
        
        .title-word:nth-child(2) {
            margin-left: 2rem;
        }
        
        .title-word:nth-child(3) {
            margin-left: 4rem;
            color: rgba(255, 255, 255, 0.9);
        }
        
        [data-theme="light"] .title-word {
            color: #fff;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.2);
        }
        
        [data-theme="dark"] .title-word {
            font-weight: 800;
        }
        
        .subtitle {
            font-size: 1.2em;
            opacity: 1;
            color: #ffffff;
            max-width: 600px;
            margin-top: 15px;
            margin-bottom: 20px;
            font-weight: 500;
            position: relative;
            z-index: 2;
            text-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        
        /* Expandable sections under header */
        .header-links {
            display: flex;
            gap: 20px;
            margin-top: 30px;
            position: relative;
            z-index: 1;
        }
        
        .expandable-link {
            color: #ffffff;
            text-decoration: none;
            font-size: 1.1em;
            padding: 8px 16px;
            border-radius: 20px;
            background-color: rgba(255, 255, 255, 0.15);
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
        }
        
        .expandable-link:hover {
            background-color: rgba(255, 255, 255, 0.25);
        }
        
        .expandable-link span {
            margin-right: 5px;
        }
        
        .expandable-link i {
            font-size: 16px;
            transition: transform 0.3s ease;
        }
        
        .expandable-link.active i {
            transform: rotate(180deg);
        }
        
        .expandable-content {
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: max-height 0.5s ease, opacity 0.5s ease, margin 0.5s ease;
            background-color: var(--surface-1);
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            margin-top: 0;
            width: 100%;
        }
        
        .expandable-content.active {
            max-height: 1000px;
            opacity: 1;
            margin-top: 20px;
            margin-bottom: 30px;
        }
        
        .expandable-inner {
            padding: 25px;
        }

        /* Theme & Text Size Toggles */
        .header-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 15px;
            z-index: 10;
        }

        .theme-toggle, .text-size-toggle {
            background: rgba(255, 255, 255, 0.15);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            padding: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .theme-toggle:hover, .text-size-toggle:hover {
            background: rgba(255, 255, 255, 0.25);
        }

        .theme-toggle .icon, .text-size-toggle .icon {
            width: 24px;
            height: 24px;
            stroke: #ffffff;
            fill: none;
            stroke-width: 2;
            transition: transform 0.3s ease;
            filter: drop-shadow(0 1px 2px rgba(0,0,0,0.2));
        }

        .theme-toggle:hover .icon, .text-size-toggle:hover .icon {
            transform: scale(1.1);
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            height: 8px;
            background-color: var(--surface-2);
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--accent-primary);
            border-radius: 4px;
            width: 0%;
            transition: width 0.3s ease-in-out;
        }

        /* Selector Section */
        .selector-section {
            background: var(--surface-1);
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            border: 1px solid var(--border-color);
        }

        .selector-section h2 {
            color: var(--accent-primary);
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        [data-theme="dark"] .selector-section h2 {
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .question-heading {
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-primary);
            font-size: 1.05rem;
            position: relative;
            display: inline-block;
            cursor: default;
            padding-bottom: 5px;
        }
        
        .question-heading::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(to right, var(--accent-primary) 0%, var(--accent-secondary) 98%, transparent 98%, transparent 100%);
            transition: width 0.3s ease;
        }
        
        .form-group:hover .question-heading::after {
            width: 100%;
        }
        
        .form-group:hover .question-heading::before {
            content: '';
            position: absolute;
            bottom: -3px;
            right: 0;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: var(--accent-primary);
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 0; }
            50% { opacity: 1; }
        }

        label {
            display: block;
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .radio-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 8px 10px;
            border-radius: 5px;
            transition: background 0.2s ease;
        }

        .radio-option:hover {
            background-color: var(--surface-2);
        }

        .radio-option input[type="radio"] {
            margin-right: 10px;
            cursor: pointer;
            width: 18px;
            height: 18px;
            accent-color: var(--accent-primary);
        }

        .radio-option label {
            margin-bottom: 0;
            cursor: pointer;
            font-weight: normal;
        }
        
        /* Grid Layout */
        .questions-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .grid-span-2 {
            grid-column: span 2;
        }
        
        .grid-span-3 {
            grid-column: span 3;
        }
        
        .radio-options-horizontal {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .radio-options-horizontal .radio-option {
            flex: 0 0 auto;
            min-width: 180px;
        }
        
        @media (max-width: 1024px) {
            .questions-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .grid-span-3 {
                grid-column: span 2;
            }
        }
        
        @media (max-width: 768px) {
            .questions-grid {
                grid-template-columns: 1fr;
            }
            
            .grid-span-2, .grid-span-3 {
                grid-column: span 1;
            }
        }

        select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s ease;
            background-color: var(--bg-color);
            color: var(--text-primary);
        }

        select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(77, 148, 255, 0.1);
        }

        .btn {
            background: var(--accent-primary);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-right: 10px;
        }

        .btn:hover {
            background: var(--accent-hover);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(77, 148, 255, 0.3);
        }

        .btn-secondary {
            background: var(--text-secondary);
        }

        /* Result Section */
        .result-section {
            background: var(--surface-1);
            border-radius: 10px;
            padding: 30px;
            margin-top: 30px;
            display: none;
            border: 1px solid var(--success);
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.1);
        }

        .result-section h3 {
            color: var(--success);
            margin-bottom: 15px;
        }

        .recommendation-box {
            background: var(--bg-color);
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
            border: 1px solid var(--border-color);
        }

        /* Common Tab Styles */
        .tab-base {
            background: none;
            border: none;
            padding: 15px 20px;
            font-size: 16px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            white-space: nowrap;
        }
        
        .tab-base.active {
            color: var(--accent-primary);
            background-color: var(--surface-1);
            position: relative;
        }
        
        .tab-container {
            background-color: var(--surface-1);
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            border: 1px solid var(--border-color);
            overflow: hidden;
            margin-bottom: 30px;
        }
        
        .tab-header {
            display: flex;
            background-color: var(--surface-2);
            border-bottom: 1px solid var(--border-color);
            overflow-x: auto;
        }
        
        .tab-content-base {
            display: none;
            padding: 0;
        }
        
        .tab-content-base.active {
            display: block;
        }
        
        /* Tabs Section */
        .tabs-section {
            margin-top: 50px;
        }

        .tabs-header {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: -2px;
            border-bottom: 2px solid var(--border-color);
            background: var(--surface-2);
            border-radius: 10px 10px 0 0;
            overflow-x: auto;
        }
        
        /* Footer links */
        .footer-links {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
        
        .footer-links a {
            color: var(--accent-primary);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s ease;
        }
        
        .footer-links a:hover {
            color: var(--accent-hover);
            text-decoration: underline;
        }
        
        .footer-author-links {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .github-link {
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .action-btn {
            background-color: var(--surface-1);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 8px 12px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s ease;
            color: var(--text-primary);
            font-size: 0.9rem;
            font-weight: normal;
        }
        
        .action-btn:hover {
            background-color: var(--surface-2);
        }
        
        .action-btn svg {
            width: 16px;
            height: 16px;
        }
        
        .document-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px auto;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
        
        .action-btn {
            background: none;
            border: none;
            color: var(--accent-primary);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9em;
            padding: 6px 10px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }
        
        .action-btn:hover {
            background-color: var(--surface-1);
            color: var(--accent-hover);
        }
        
        .action-btn svg {
            width: 16px;
            height: 16px;
            stroke-width: 2;
            stroke: currentColor;
        }
        
        /* Top links */
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .top-links {
            display: flex;
            gap: 15px;
        }
        
        .top-links a {
            color: var(--accent-primary);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            opacity: 0.85;
        }
        
        .top-links a:hover {
            color: var(--accent-hover);
            opacity: 1;
        }

        .tab-button {
            background: none;
            border: none;
            padding: 15px 25px;
            font-size: 16px;
            color: var(--text-secondary);
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            font-weight: 500;
            white-space: nowrap;
        }

        .tab-button.active {
            color: var(--accent-primary);
            border-bottom-color: var(--accent-primary);
            background: var(--surface-1);
        }

        .tab-content {
            display: none;
            padding: 30px;
            background: var(--surface-1);
            border-radius: 0 0 10px 10px;
            border-top: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Table Styles */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        th {
            background: var(--header-bg);
            color: white;
            padding: 15px 12px;
            font-weight: 600;
            text-align: left;
        }

        td {
            padding: 12px;
            border: 1px solid var(--border-color);
            background: var(--bg-color);
        }

        tr:nth-child(even) td {
            background: var(--surface-1);
        }

        tr:hover td {
            background: var(--surface-2);
        }

        /* Content Sections */
        .content-section {
            margin-bottom: 35px;
        }

        .content-section h3 {
            color: var(--accent-primary);
            margin-bottom: 15px;
            font-size: 1.4em;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 8px;
        }

        [data-theme="dark"] .content-section h3 {
            font-weight: 600;
        }

        .content-section ul {
            padding-left: 25px;
            margin-bottom: 15px;
        }

        .content-section li {
            margin-bottom: 8px;
        }

        /* Main Content and Intro Tabs */
        .main-content-section {
            margin-bottom: 40px;
        }
        
        .intro-tabs {
            background-color: var(--surface-1);
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            border: 1px solid var(--border-color);
            overflow: hidden;
        }
        
        .intro-tabs-header {
            display: flex;
            background-color: var(--surface-2);
            border-bottom: 1px solid var(--border-color);
        }
        
        .intro-tab-button {
            flex: 1;
            background: none;
            border: none;
            border-right: 1px solid var(--border-color);
            padding: 15px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-secondary);
            transition: all 0.3s ease;
        }
        
        .intro-tab-button:last-child {
            border-right: none;
        }
        
        .intro-tab-button.active {
            background-color: var(--surface-1);
            color: var(--accent-primary);
            border-bottom: 3px solid var(--accent-primary);
        }
        
        .intro-tab-button:hover:not(.active) {
            background-color: rgba(0,0,0,0.05);
            color: var(--text-primary);
        }
        
        .intro-tab-content {
            display: none;
            padding: 0;
        }
        
        .intro-tab-content.active {
            display: block;
        }
        
        .tab-inner-content {
            padding: 25px;
        }
        
        .tab-inner-content h3 {
            margin-bottom: 15px;
            color: var(--accent-primary);
        }
        
        .roman-list {
            list-style-type: lower-roman;
            padding-left: 30px;
            margin-bottom: 20px;
        }
        
        .roman-list li {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        /* Export Section */
        /* Removed export-section styles as we're moving to footer */

        /* Removed export-section heading styles */

        /* Citation Styling */
        .citation {
            background: var(--surface-2);
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 4px solid var(--accent-primary);
        }

        .citation h4 {
            color: var(--accent-primary);
            margin-bottom: 8px;
        }

        .citation p {
            margin-bottom: 5px;
        }

        .citation ul {
            list-style: none;
            padding-left: 10px;
        }

        .citation a {
            color: var(--accent-secondary);
            text-decoration: none;
        }

        .citation a:hover {
            text-decoration: underline;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            h1 {
                font-size: 2em;
            }

            .tab-button {
                padding: 12px 15px;
                font-size: 14px;
            }

            table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
        }

        /* Print Styles */
        @media print {
            body {
                background: white;
                color: black;
            }

            .selector-section,
            .export-section,
            .btn,
            .theme-toggle,
            .document-actions,
            .top-links {
                display: none;
            }

            .tabs-header {
                display: none;
            }

            .tab-content {
                display: block !important;
                page-break-after: always;
                background: white;
                color: black;
            }

            .tab-content:last-child {
                page-break-after: avoid;
            }

            table {
                box-shadow: none;
            }

            th {
                background: #f0f0f0;
                color: black;
            }

            td {
                background: white;
                color: black;
            }
            
            /* Print footer */
            @page {
                margin-bottom: 2cm;
            }
            
            .print-footer {
                display: block;
                position: fixed;
                bottom: 0;
                width: 100%;
                text-align: center;
                font-size: 10pt;
                padding: 10px 0;
                border-top: 1px solid #ccc;
            }
        }
        
        /* Hidden print footer */
        .print-footer {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-top">
            <div></div> <!-- Empty div for flex spacing -->
            <div class="top-links">
                <a href="https://www.linkedin.com/in/thecontractor/" target="_blank" rel="noopener noreferrer">
                    Author
                </a>
                <a href="https://github.com/Splinters-io/WTM" target="_blank" rel="noopener noreferrer" class="github-link">
                    <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
                    </svg>
                    GitHub
                </a>
            </div>
        </div>
        
        <header>
            <div class="header-controls">
                <button class="text-size-toggle" onclick="cycleTextSize()" aria-label="Adjust text size">
                    <svg class="icon" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
                        <text id="size-indicator" x="12" y="16" text-anchor="middle" font-size="14" stroke-width="1">A</text>
                        <circle id="size-circle" cx="12" cy="12" r="10" stroke-width="1" fill="none"/>
                    </svg>
                </button>
                <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle dark/light mode">
                    <svg class="icon" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
                        <path id="moon-icon" d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" style="display: none;"/>
                        <circle id="sun-icon" cx="12" cy="12" r="5"/>
                        <path id="sun-rays" d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
                    </svg>
                </button>
            </div>
            <div class="mega-title">
                <h1>
                    <span class="title-word">Threat</span>
                    <span class="title-word">Model</span>
                    <span class="title-word">Selector</span>
                </h1>
            </div>
            <p class="subtitle">Find the right threat modeling methodology for your needs and access RACI charts</p>
            
            <div class="header-links">
                <a class="expandable-link active" onclick="toggleExpandable('how-to-use-content')">
                    <span>Who might need this</span>
                    <i>▼</i>
                </a>
                <a class="expandable-link" onclick="toggleExpandable('motivations-content')">
                    <span>Motivations</span>
                    <i>▼</i>
                </a>
            </div>
            
            <div id="how-to-use-content" class="expandable-content active">
                <div class="expandable-inner">
                    <h3>Who might need this tool</h3>
                    <p>This tool is designed for anyone who wants to ensure they're using the most appropriate threat modeling methodology for their specific needs. Threat models have specific values and use cases - picking the right one matters.</p>
                    
                    <p>The idea is to ask just 5 basic questions, those answers will grant a recommendation to the best threat modeling approach for your situation, it's an excellent starter for 10 or point of conversation</p>
                    
                    <h4 style="margin-top: 20px; color: var(--accent-primary);">How to use:</h4>
                    <ol class="roman-list">
                        <li>Answer the questions in the section below</li>
                        <li>View your recommended methodology</li> 
                        <li>Explore the various methodologies to understand their differences</li>
                        <li>Examine the RACI matrix for your chosen methodology</li>
                        <li>Export or print the information for your team</li>
                    </ol>
                </div>
            </div>
            
            <div id="motivations-content" class="expandable-content">
                <div class="expandable-inner">
                    <p>Answer a few quick questions to find the most appropriate threat modeling methodology for your needs.</p>
                    
                    <!-- Threat Modeling Tool Analogy Section -->
                    <div style="background: var(--surface-2); border-left: 4px solid var(--accent-primary); padding: 20px; margin: 20px 0; border-radius: 8px;">
                        <h3 style="color: var(--accent-primary); margin-bottom: 10px;">Why Use More Than Just CIA?</h3>
                        <p style="margin-bottom: 15px;">While CIA (Confidentiality, Integrity, Availability) is fundamental and widely used, relying solely on it is like having only a flathead screwdriver in your toolbox. It's not that the flathead is bad—it's essential! But sometimes you need a Phillips head, a Torq, or a hex key.</p>
                        
                        <p style="margin-bottom: 15px;">Each threat modeling methodology serves as a different tool in your security toolkit:</p>
                        
                        <ul style="margin-left: 20px; margin-bottom: 15px;">
                            <li><strong>CIA</strong> is your basic flathead—universally applicable, simple, and great for foundational understanding</li>
                            <li><strong>STRIDE</strong> is your Phillips head—precise for technical systems with clear attack vectors</li>
                            <li><strong>LINDDUN</strong> is your specialized privacy tool—perfect for data protection scenarios</li>
                            <li><strong>PASTA</strong> is your precision torque tool—ideal for attack simulation and risk quantification</li>
                            <li><strong>OCTAVE</strong> is your heavy-duty wrench—built for organizational-level risk management</li>
                            <li><strong>TRIKE</strong> is your adjustable tool—flexible for risk framework integration</li>
                            <li><strong>DREDD</strong> is your data-focused instrument—specialized for data-centric security concerns</li>
                        </ul>
                        
                        <p style="font-style: italic;">The right tool for the right job makes all the difference. Let's find yours</p>
                        
                        <p style="margin-top: 15px;">It's nice when others know that there are more appropriate threat models than CIA-ing everything, so this was a fun little utility to make.</p>
                    </div>
                </div>
            </div>
        </header>

        <div class="main-content-section">
            <div class="selector-section">
                <h2>Questions</h2>
                <p>Answer these questions to discover which threat modeling approach best suits your needs.</p>
                
                <div class="progress-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
        
                <form id="threatModelSelector">
                    <div class="questions-grid">
                        <div class="form-group">
                            <div class="question-heading">What is your project/organization scale?</div>
                            <div class="radio-options">
                                <div class="radio-option">
                                    <input type="radio" id="scale-component" name="scale" value="component" onchange="updateProgress()">
                                    <label for="scale-component">Component/Single Application</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="scale-system" name="scale" value="system" onchange="updateProgress()">
                                    <label for="scale-system">Full System</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="scale-organization" name="scale" value="organization" onchange="updateProgress()">
                                    <label for="scale-organization">Organization-wide</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="scale-all" name="scale" value="all" onchange="updateProgress()">
                                    <label for="scale-all">All levels</label>
                                </div>
                            </div>
                        </div>
                                
                                <div class="form-group">
                                    <div class="question-heading">What's your team's security expertise level?</div>
                                    <div class="radio-options">
                                        <div class="radio-option">
                                            <input type="radio" id="expertise-general" name="expertise" value="general" onchange="updateProgress()">
                                            <label for="expertise-general">General/Beginner</label>
                                        </div>
                                        <div class="radio-option">
                                            <input type="radio" id="expertise-technical" name="expertise" value="technical" onchange="updateProgress()">
                                            <label for="expertise-technical">Technical</label>
                                        </div>
                                        <div class="radio-option">
                                            <input type="radio" id="expertise-privacy" name="expertise" value="privacy" onchange="updateProgress()">
                                            <label for="expertise-privacy">Privacy-focused</label>
                                        </div>
                                        <div class="radio-option">
                                            <input type="radio" id="expertise-business" name="expertise" value="business" onchange="updateProgress()">
                                            <label for="expertise-business">Business-oriented</label>
                                        </div>
                                        <div class="radio-option">
                                            <input type="radio" id="expertise-security" name="expertise" value="security" onchange="updateProgress()">
                                            <label for="expertise-security">Advanced Security</label>
                                        </div>
                                        <div class="radio-option">
                                            <input type="radio" id="expertise-risk" name="expertise" value="risk" onchange="updateProgress()">
                                            <label for="expertise-risk">Risk Management</label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <div class="question-heading">How much time can you invest?</div>
                                    <div class="radio-options">
                                        <div class="radio-option">
                                            <input type="radio" id="time-low" name="time" value="low" onchange="updateProgress()">
                                            <label for="time-low">Low (Quick assessment)</label>
                                        </div>
                                        <div class="radio-option">
                                            <input type="radio" id="time-medium" name="time" value="medium" onchange="updateProgress()">
                                            <label for="time-medium">Medium (Moderate effort)</label>
                                        </div>
                                        <div class="radio-option">
                                            <input type="radio" id="time-high" name="time" value="high" onchange="updateProgress()">
                                            <label for="time-high">High (Comprehensive analysis)</label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <div class="question-heading">What's your primary focus area?</div>
                                    <div class="radio-options">
                                        <div class="radio-option">
                                            <input type="radio" id="focus-fundamentals" name="focus" value="fundamentals" onchange="updateProgress()">
                                            <label for="focus-fundamentals">Security Fundamentals</label>
                                        </div>
                                        <div class="radio-option">
                                            <input type="radio" id="focus-security" name="focus" value="security" onchange="updateProgress()">
                                            <label for="focus-security">Technical Security</label>
                                        </div>
                                        <div class="radio-option">
                                            <input type="radio" id="focus-privacy" name="focus" value="privacy" onchange="updateProgress()">
                                            <label for="focus-privacy">Privacy Protection</label>
                                        </div>
                                        <div class="radio-option">
                                            <input type="radio" id="focus-operations" name="focus" value="operations" onchange="updateProgress()">
                                            <label for="focus-operations">Operations & Business</label>
                                        </div>
                                        <div class="radio-option">
                                            <input type="radio" id="focus-attack" name="focus" value="attack" onchange="updateProgress()">
                                            <label for="focus-attack">Attack Simulation</label>
                                        </div>
                                        <div class="radio-option">
                                            <input type="radio" id="focus-risk" name="focus" value="risk" onchange="updateProgress()">
                                            <label for="focus-risk">Risk Management</label>
                                        </div>
                                    </div>
                                </div>
                            
                                <div class="form-group">
                                    <div class="question-heading">At what phase are you in development?</div>
                                    <div class="radio-options">
                                        <div class="radio-option">
                                            <input type="radio" id="phase-requirements" name="phase" value="requirements" onchange="updateProgress()">
                                            <label for="phase-requirements">Requirements Gathering</label>
                                        </div>
                                        <div class="radio-option">
                                            <input type="radio" id="phase-design" name="phase" value="design" onchange="updateProgress()">
                                            <label for="phase-design">Design Phase</label>
                                        </div>
                                        <div class="radio-option">
                                            <input type="radio" id="phase-testing" name="phase" value="testing" onchange="updateProgress()">
                                            <label for="phase-testing">Testing Phase</label>
                                        </div>
                                        <div class="radio-option">
                                            <input type="radio" id="phase-planning" name="phase" value="planning" onchange="updateProgress()">
                                            <label for="phase-planning">Strategic Planning</label>
                                        </div>
                                        <div class="radio-option">
                                            <input type="radio" id="phase-all" name="phase" value="all" onchange="updateProgress()">
                                            <label for="phase-all">All Phases</label>
                                        </div>
                                    </div>
                                </div>
                            
                            <div class="form-group grid-span-3">
                                <button type="button" onclick="findThreatModel()" class="btn">Get Recommendation</button>
                            </div>
                        </div>
                        </form>
                            
                            <div id="result" class="result-section">
                                <h3>Recommended Threat Model:</h3>
                                <div id="recommendation" class="recommendation-box"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tabs-section tab-container">
            <div class="tabs-header tab-header">
                <button class="tab-button tab-base active" onclick="openTab(event, 'overview')">Overview</button>
                <button class="tab-button tab-base" onclick="openTab(event, 'selection')">Selection Guide</button>
                <button class="tab-button tab-base" onclick="openTab(event, 'cia')">CIA Triad</button>
                <button class="tab-button tab-base" onclick="openTab(event, 'stride')">STRIDE</button>
                <button class="tab-button tab-base" onclick="openTab(event, 'dredd')">DREDD</button>
                <button class="tab-button tab-base" onclick="openTab(event, 'octave')">OCTAVE</button>
                <button class="tab-button tab-base" onclick="openTab(event, 'pasta')">PASTA</button>
                <button class="tab-button tab-base" onclick="openTab(event, 'linddun')">LINDDUN</button>
                <button class="tab-button tab-base" onclick="openTab(event, 'trike')">TRIKE</button>
            </div>

            <div id="overview" class="tab-content tab-content-base active">
                <h2>Threat Modeling Methodologies Overview</h2>
                <p>This comprehensive guide provides detailed RACI (Responsible, Accountable, Consulted, Informed) matrices for seven major threat modeling methodologies. Each methodology has unique strengths and is suited for different organizational contexts, security requirements, and project phases.</p>
                
                <div class="content-section">
                    <h3>Available Methodologies</h3>
                    <ul>
                        <li><strong>STRIDE:</strong> Microsoft's comprehensive security threat modeling framework</li>
                        <li><strong>LINDDUN:</strong> Privacy-focused threat modeling methodology</li>
                        <li><strong>OCTAVE:</strong> Organizational-level risk assessment framework</li>
                        <li><strong>PASTA:</strong> Process for Attack Simulation and Threat Analysis</li>
                        <li><strong>CIA Triad:</strong> Fundamental information security principles</li>
                        <li><strong>TRIKE:</strong> Risk management-focused threat modeling approach</li>
                        <li><strong>DREDD:</strong> Data Risk Evaluation, Detection, and Defense framework</li>
                    </ul>
                </div>
                
            </div>

            <div id="stride" class="tab-content tab-content-base">
                <h2>STRIDE Threat Modeling</h2>
                
                <div class="citation">
                    <h4>Citation</h4>
                    <p>Developed by Microsoft in the late 1990s by Praerit Garg and Loren Kohnfelder. Microsoft Security Development Lifecycle (SDL).</p>
                    <h4>URLs:</h4>
                    <ul>
                        <li><a href="https://learn.microsoft.com/en-us/azure/security/develop/threat-modeling-tool" target="_blank">Microsoft Threat Modeling Tool</a></li>
                        <li><a href="https://www.microsoft.com/en-us/securityengineering/sdl/threatmodeling" target="_blank">SDL Threat Modeling Process</a></li>
                        <li><a href="https://learn.microsoft.com/en-us/azure/security/develop/threat-modeling-tool-getting-started" target="_blank">Threat Modeling Tool Overview</a></li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>Best for:</h3>
                    <ul>
                        <li><strong>Timing:</strong> Early design phases and throughout development</li>
                        <li><strong>Context:</strong> Complex systems with multiple components and trust boundaries</li>
                        <li><strong>Focus:</strong> Comprehensive security threat identification</li>
                        <li><strong>Organizations:</strong> Development teams and system integrators</li>
                        <li><strong>Use cases:</strong> Software applications, distributed systems, cloud architectures</li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>STRIDE RACI Matrix</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Role/Group</th>
                                <th>Responsible</th>
                                <th>Accountable</th>
                                <th>Consulted</th>
                                <th>Informed</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Project Manager</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Security Officer</td>
                                <td>X</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>System Architect</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Development Team Lead</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Network Administrator</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Cloud/DevOps Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Software Developers</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Governance Board</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                            <tr>
                                <td>Business Stakeholders</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                            <tr>
                                <td>Suppliers/Vendors</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Legal/Compliance Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="linddun" class="tab-content tab-content-base">
                <h2>LINDDUN Threat Modeling</h2>
                
                <div class="citation">
                    <h4>Citation</h4>
                    <p>Developed by KU Leuven researchers Kim Wuyts, Riccardo Scandariato, Wouter Joosen (2015). "LINDDUN Privacy Threat Trees: A Systematic Methodology for Privacy Risk Management."</p>
                    <h4>URLs:</h4>
                    <ul>
                        <li><a href="https://linddun.org/" target="_blank">Official LINDDUN Framework</a></li>
                        <li><a href="https://www.nist.gov/privacy-framework/linddun-privacy-threat-modeling-framework" target="_blank">NIST Privacy Framework</a></li>
                        <li><a href="https://www.cs.kuleuven.be/~distrinet/" target="_blank">KU Leuven DistriNet Research</a></li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>Best for:</h3>
                    <ul>
                        <li><strong>Timing:</strong> Early design phase and privacy impact assessments</li>
                        <li><strong>Context:</strong> Systems processing personal data</li>
                        <li><strong>Focus:</strong> Privacy-specific threats and data protection</li>
                        <li><strong>Organizations:</strong> GDPR-compliant entities, healthcare, finance</li>
                        <li><strong>Use cases:</strong> Personal data systems, IoT devices, mobile applications</li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>LINDDUN RACI Matrix</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Role/Group</th>
                                <th>Responsible</th>
                                <th>Accountable</th>
                                <th>Consulted</th>
                                <th>Informed</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Privacy Officer</td>
                                <td>X</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Data Protection Officer</td>
                                <td>X</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Security Analyst</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Legal Counsel</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Business Process Owner</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Data Engineering Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>UX/Product Team</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Compliance Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Management Board</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                            <tr>
                                <td>Data Subjects Representatives</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Third-party Processors</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="octave" class="tab-content tab-content-base">
                <h2>OCTAVE Threat Modeling</h2>
                
                <div class="citation">
                    <h4>Citation</h4>
                    <p>Developed by Carnegie Mellon University's Software Engineering Institute (SEI) and CERT Coordination Center. First introduced in 1999 by Christopher Alberts and Audrey Dorofee.</p>
                    <h4>URLs:</h4>
                    <ul>
                        <li><a href="https://insights.sei.cmu.edu/library/operationally-critical-threat-asset-and-vulnerability-evaluation-octave-framework-version-10/" target="_blank">SEI OCTAVE Overview</a></li>
                        <li><a href="https://resources.sei.cmu.edu/library/asset-view.cfm?assetid=8419" target="_blank">OCTAVE Allegro</a></li>
                        <li><a href="https://insights.sei.cmu.edu/blog/threat-modeling-12-available-methods/" target="_blank">SEI Threat Modeling Resources</a></li>
                        <li><a href="https://resources.sei.cmu.edu/library/asset-view.cfm?assetid=309051" target="_blank">OCTAVE Related Assets</a></li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>Best for:</h3>
                    <ul>
                        <li><strong>Timing:</strong> Organizational risk assessment cycles</li>
                        <li><strong>Context:</strong> Large organizations needing self-directed assessments</li>
                        <li><strong>Focus:</strong> Operational risk management and organizational assets</li>
                        <li><strong>Organizations:</strong> Enterprises with established risk management programs</li>
                        <li><strong>Use cases:</strong> Critical infrastructure, organizational security planning</li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>OCTAVE RACI Matrix</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Role/Group</th>
                                <th>Responsible</th>
                                <th>Accountable</th>
                                <th>Consulted</th>
                                <th>Informed</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>OCTAVE Team Lead</td>
                                <td>X</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Business Unit Managers</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>IT Operations Manager</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Risk Management Team</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Asset Owners</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Information Security Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>External Consultants</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Executive Sponsor</td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Legal/Audit Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Business Stakeholders</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                            <tr>
                                <td>Board of Directors</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="pasta" class="tab-content tab-content-base">
                <h2>PASTA Threat Modeling</h2>
                
                <div class="citation">
                    <h4>Citation</h4>
                    <p>Developed by Tony UcedaVelez and Marco M. Morana. Published in "Risk Centric Threat Modeling: Process for Attack Simulation and Threat Analysis" (2015).</p>
                    <h4>URLs:</h4>
                    <ul>
                        <li><a href="https://versprite.com/cybersecurity-listings/offsec/pasta-threat-modeling/" target="_blank">VerSprite PASTA Methodology</a></li>
                        <li><a href="https://threat-modeling.com/pasta-threat-modeling/" target="_blank">PASTA Framework Guide</a></li>
                        <li><a href="https://www.iriusrisk.com/resources-blog/pasta-threat-modeling-methodologies" target="_blank">PASTA Threat Modeling Overview</a></li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>Best for:</h3>
                    <ul>
                        <li><strong>Timing:</strong> During security architecture and testing phases</li>
                        <li><strong>Context:</strong> Systems requiring quantitative risk assessment</li>
                        <li><strong>Focus:</strong> Attack simulation and risk-based security testing</li>
                        <li><strong>Organizations:</strong> Security-focused teams with attack modeling expertise</li>
                        <li><strong>Use cases:</strong> High-risk applications, financial systems, critical infrastructure</li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>PASTA RACI Matrix</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Role/Group</th>
                                <th>Responsible</th>
                                <th>Accountable</th>
                                <th>Consulted</th>
                                <th>Informed</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Threat Analyst</td>
                                <td>X</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Attack Simulation Team</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Risk Assessment Team</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Security Architect</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Red Team/Penetration Testers</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Quantitative Risk Analysts</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Business Impact Analysts</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Management Team</td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Development Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Incident Response Team</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                            <tr>
                                <td>Stakeholders</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="cia" class="tab-content tab-content-base">
                <h2>CIA Triad</h2>
                
                <div class="citation">
                    <h4>Citation</h4>
                    <p>Fundamental information security model attributed to multiple sources, formally described by Jerome Saltzer and Michael Schroeder in "The Protection of Information in Computer Systems" (1975). Widely adopted across information security frameworks.</p>
                    <h4>URLs:</h4>
                    <ul>
                        <li><a href="https://csrc.nist.gov/glossary/term/CIA" target="_blank">NIST Cybersecurity Glossary</a></li>
                        <li><a href="https://www.nist.gov/image/cia-triad" target="_blank">NIST CIA Triad Overview</a></li>
                        <li><a href="https://complianceforge.com/free-guides/confidentiality-integrity-availability-security/" target="_blank">ComplianceForge CIA/CIAS Model</a></li>
                        <li><a href="https://csrc.nist.gov/" target="_blank">NIST Cybersecurity Framework Documentation</a></li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>Best for:</h3>
                    <ul>
                        <li><strong>Timing:</strong> Continuous application across all security activities</li>
                        <li><strong>Context:</strong> Foundational security analysis for any system</li>
                        <li><strong>Focus:</strong> Basic security properties assessment</li>
                        <li><strong>Organizations:</strong> All organizations implementing security controls</li>
                        <li><strong>Use cases:</strong> General security planning, security awareness, policy development</li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>CIA Triad RACI Matrix</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Role/Group</th>
                                <th>Responsible</th>
                                <th>Accountable</th>
                                <th>Consulted</th>
                                <th>Informed</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Information Security Manager</td>
                                <td>X</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>System Administrators</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Database Administrators</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Network Security Team</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Data Classification Officer</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Access Control Team</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Business Unit Heads</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Compliance Officer</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Executive Leadership</td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>All Staff</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                            <tr>
                                <td>External Auditors</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="trike" class="tab-content tab-content-base">
                <h2>TRIKE Threat Modeling</h2>
                
                <div class="citation">
                    <h4>Citation</h4>
                    <p>Open source threat modeling methodology developed by Brenda Larcom and Eleanor Saitta. First presented at the Security and Privacy Summit in 2006.</p>
                    <h4>URLs:</h4>
                    <ul>
                        <li><a href="https://trike.sourceforge.net/" target="_blank">Official Trike Project</a></li>
                        <li><a href="https://trike.sourceforge.net/docs.shtml" target="_blank">TRIKE Documentation</a></li>
                        <li><a href="https://trike.sourceforge.net/papers/" target="_blank">TRIKE Papers</a></li>
                        <li><a href="https://www.researchgate.net/publication/229046782_Trike_v_1_Methodology_Document_Draft" target="_blank">TRIKE Methodology Document</a></li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>Best for:</h3>
                    <ul>
                        <li><strong>Timing:</strong> Requirements gathering and risk management phases</li>
                        <li><strong>Context:</strong> Organizations with existing risk frameworks</li>
                        <li><strong>Focus:</strong> Risk management integration with security requirements</li>
                        <li><strong>Organizations:</strong> Mature security programs with risk management integration</li>
                        <li><strong>Use cases:</strong> Enterprise security planning, regulatory compliance</li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>TRIKE RACI Matrix</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Role/Group</th>
                                <th>Responsible</th>
                                <th>Accountable</th>
                                <th>Consulted</th>
                                <th>Informed</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Risk Management Lead</td>
                                <td>X</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Security Analysts</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Business Analysts</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Asset Managers</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Threat Modelers</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>System Architects</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Security Requirements Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Executive Sponsor</td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Audit Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Project Management Office</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                            <tr>
                                <td>Development Teams</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div id="dredd" class="tab-content tab-content-base">
                <h2>DREDD Threat Modeling</h2>
                
                <div class="citation">
                    <h4>Citation</h4>
                    <p>Developed as a specialized framework for Data Risk Evaluation, Detection, and Defense (DREDD). Originated from research on data-centric security models at the intersection of privacy engineering and threat modeling.</p>
                    <h4>URLs:</h4>
                    <ul>
                        <li><a href="https://datatracker.ietf.org/doc/html/draft-hanley-oauth-security-design" target="_blank">IETF Security Design Process</a></li>
                        <li><a href="https://www.nist.gov/privacy-framework" target="_blank">NIST Privacy Framework</a></li>
                        <li><a href="https://www.riskbasedsecurity.com/" target="_blank">Risk Based Security</a></li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>Best for:</h3>
                    <ul>
                        <li><strong>Timing:</strong> Early data architecture planning and throughout data lifecycle</li>
                        <li><strong>Context:</strong> Data-intensive applications and platforms with complex data flows</li>
                        <li><strong>Focus:</strong> Data-centric risk evaluation and protection strategies</li>
                        <li><strong>Organizations:</strong> Data stewards, cloud providers, and data aggregation services</li>
                        <li><strong>Use cases:</strong> Big data platforms, data lakes, AI/ML systems, healthcare data systems</li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>DREDD RACI Matrix</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Role/Group</th>
                                <th>Responsible</th>
                                <th>Accountable</th>
                                <th>Consulted</th>
                                <th>Informed</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Data Protection Officer</td>
                                <td>X</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Data Architects</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Data Engineers</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Data Scientists</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Security Analysts</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Cloud Security Specialists</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Compliance Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Privacy Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Executive Data Sponsor</td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Data Governance Board</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Business Stakeholders</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="content-section">
                    <h3>Key Components</h3>
                    <ul>
                        <li><strong>Data Risk Profiling:</strong> Systematic evaluation of data sensitivity, value, and exposure risk</li>
                        <li><strong>Evaluation Framework:</strong> Metrics-driven approach to quantify data-specific risks</li>
                        <li><strong>Detection Mechanisms:</strong> Continuous monitoring strategies for data misuse and exfiltration</li>
                        <li><strong>Defense-in-Depth:</strong> Layered protection strategies specific to data types and flows</li>
                        <li><strong>Data Lifecycle Assessment:</strong> Security controls mapped to each phase of the data lifecycle</li>
                    </ul>
                </div>
            </div>

            <div id="selection" class="tab-content tab-content-base">
                <h2>Selection Criteria Summary</h2>
                
                <div class="content-section">
                    <table>
                        <thead>
                            <tr>
                                <th>Criteria</th>
                                <th>STRIDE</th>
                                <th>LINDDUN</th>
                                <th>OCTAVE</th>
                                <th>PASTA</th>
                                <th>CIA</th>
                                <th>TRIKE</th>
                                <th>DREDD</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Complexity</strong></td>
                                <td>Medium</td>
                                <td>Medium</td>
                                <td>High</td>
                                <td>High</td>
                                <td>Low</td>
                                <td>Medium</td>
                                <td>Medium-High</td>
                            </tr>
                            <tr>
                                <td><strong>Required Expertise</strong></td>
                                <td>Technical</td>
                                <td>Privacy</td>
                                <td>Business</td>
                                <td>Security</td>
                                <td>General</td>
                                <td>Risk</td>
                                <td>Data</td>
                            </tr>
                            <tr>
                                <td><strong>Time Investment</strong></td>
                                <td>Medium</td>
                                <td>Medium</td>
                                <td>High</td>
                                <td>High</td>
                                <td>Low</td>
                                <td>Medium</td>
                                <td>Medium-High</td>
                            </tr>
                            <tr>
                                <td><strong>Focus Area</strong></td>
                                <td>Security</td>
                                <td>Privacy</td>
                                <td>Operations</td>
                                <td>Attack Simulation</td>
                                <td>Fundamentals</td>
                                <td>Risk Management</td>
                                <td>Data Protection</td>
                            </tr>
                            <tr>
                                <td><strong>Best Phase</strong></td>
                                <td>Design</td>
                                <td>Design</td>
                                <td>Planning</td>
                                <td>Testing</td>
                                <td>All</td>
                                <td>Requirements</td>
                                <td>Architecture</td>
                            </tr>
                            <tr>
                                <td><strong>Scale</strong></td>
                                <td>Component-System</td>
                                <td>System</td>
                                <td>Organization</td>
                                <td>System</td>
                                <td>All</td>
                                <td>Enterprise</td>
                                <td>Data Systems</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="content-section">
                    <h3>Key Recommendations</h3>
                    <ol class="roman-list">
                        <li><strong>Start with CIA</strong> for foundational understanding</li>
                        <li><strong>Use STRIDE</strong> for technical system threat modeling</li>
                        <li><strong>Apply LINDDUN</strong> when privacy is critical</li>
                        <li><strong>Consider PASTA</strong> for attack-centric analysis</li>
                        <li><strong>Implement OCTAVE</strong> for organizational-level assessment</li>
                        <li><strong>Use TRIKE</strong> when integrating with existing risk frameworks</li>
                        <li><strong>Choose DREDD</strong> for data-intensive systems and data flow security</li>
                    </ol>
                    
                    <p><strong>Remember:</strong> These models can be combined based on organizational needs. Many teams use a hybrid approach, starting with CIA/STRIDE and adding privacy-focused LINDDUN, data-centric DREDD, or risk-focused OCTAVE/TRIKE as needed.</p>
                </div>
            </div>
        </div>

    </div>

    <script>
        // Initialize theme and text size
        let currentTheme = 'light';
        let currentTextSize = 'medium';
        document.documentElement.setAttribute('data-theme', currentTheme);
        document.documentElement.style.setProperty('--text-size-factor', 'var(--text-size-medium)');

        // Theme toggle
        function toggleTheme() {
            currentTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', currentTheme);
            
            const moonIcon = document.getElementById('moon-icon');
            const sunIcon = document.getElementById('sun-icon');
            const sunRays = document.getElementById('sun-rays');
            
            if (currentTheme === 'light') {
                moonIcon.style.display = 'none';
                sunIcon.style.display = 'block';
                sunRays.style.display = 'block';
            } else {
                moonIcon.style.display = 'block';
                sunIcon.style.display = 'none';
                sunRays.style.display = 'none';
            }
        }
        
        // Text size toggle
        function cycleTextSize() {
            const sizeIndicator = document.getElementById('size-indicator');
            
            if (currentTextSize === 'small') {
                currentTextSize = 'medium';
                document.documentElement.style.setProperty('--text-size-factor', 'var(--text-size-medium)');
                sizeIndicator.setAttribute('font-size', '14');
            } else if (currentTextSize === 'medium') {
                currentTextSize = 'large';
                document.documentElement.style.setProperty('--text-size-factor', 'var(--text-size-large)');
                sizeIndicator.setAttribute('font-size', '18');
            } else {
                currentTextSize = 'small';
                document.documentElement.style.setProperty('--text-size-factor', 'var(--text-size-small)');
                sizeIndicator.setAttribute('font-size', '12');
            }
        }

        // Progress bar update
        function updateProgress() {
            const radioGroups = ['scale', 'expertise', 'time', 'focus', 'phase'];
            let completed = 0;
            
            radioGroups.forEach(name => {
                const radios = document.querySelectorAll(`input[name="${name}"]:checked`);
                if (radios.length > 0) {
                    completed++;
                }
            });
            
            const progress = (completed / radioGroups.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }

        // Tab functionality
        function openTab(evt, tabName) {
            const tabcontent = document.getElementsByClassName("tab-content");
            for (let i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.remove("active");
            }
            
            const tabbuttons = document.getElementsByClassName("tab-button");
            for (let i = 0; i < tabbuttons.length; i++) {
                tabbuttons[i].classList.remove("active");
            }
            
            document.getElementById(tabName).classList.add("active");
            evt.currentTarget.classList.add("active");
        }

        // Threat model selector
        function findThreatModel() {
            const scale = document.querySelector('input[name="scale"]:checked')?.value;
            const expertise = document.querySelector('input[name="expertise"]:checked')?.value;
            const time = document.querySelector('input[name="time"]:checked')?.value;
            const focus = document.querySelector('input[name="focus"]:checked')?.value;
            const phase = document.querySelector('input[name="phase"]:checked')?.value;
            
            if (!scale || !expertise || !time || !focus || !phase) {
                alert('Please answer all questions before getting a recommendation.');
                return;
            }
            
            let scores = {
                STRIDE: 0,
                LINDDUN: 0,
                OCTAVE: 0,
                PASTA: 0,
                CIA: 0,
                TRIKE: 0,
                DREDD: 0
            };
            
            // Scale scoring
            if (scale === 'component') {
                scores.STRIDE += 3;
                scores.CIA += 2;
                scores.PASTA += 2;
            } else if (scale === 'system') {
                scores.STRIDE += 3;
                scores.LINDDUN += 2;
                scores.PASTA += 3;
                scores.DREDD += 2;
            } else if (scale === 'organization') {
                scores.OCTAVE += 3;
                scores.TRIKE += 2;
            } else if (scale === 'all') {
                scores.CIA += 3;
                scores.DREDD += 1;
            }
            
            // Expertise scoring
            if (expertise === 'general') {
                scores.CIA += 3;
                scores.STRIDE += 1;
            } else if (expertise === 'technical') {
                scores.STRIDE += 3;
                scores.PASTA += 2;
                scores.DREDD += 1;
            } else if (expertise === 'privacy') {
                scores.LINDDUN += 3;
                scores.DREDD += 2;
            } else if (expertise === 'business') {
                scores.OCTAVE += 3;
                scores.TRIKE += 2;
            } else if (expertise === 'security') {
                scores.PASTA += 3;
                scores.STRIDE += 2;
                scores.DREDD += 1;
            } else if (expertise === 'risk') {
                scores.TRIKE += 3;
                scores.OCTAVE += 2;
                scores.DREDD += 1;
            }
            
            // Time scoring
            if (time === 'low') {
                scores.CIA += 3;
                scores.STRIDE += 1;
            } else if (time === 'medium') {
                scores.STRIDE += 2;
                scores.LINDDUN += 2;
                scores.TRIKE += 2;
                scores.DREDD += 2;
            } else if (time === 'high') {
                scores.OCTAVE += 3;
                scores.PASTA += 3;
                scores.DREDD += 3;
            }
            
            // Focus scoring
            if (focus === 'fundamentals') {
                scores.CIA += 3;
            } else if (focus === 'security') {
                scores.STRIDE += 3;
                scores.DREDD += 1;
            } else if (focus === 'privacy') {
                scores.LINDDUN += 3;
                scores.DREDD += 2;
            } else if (focus === 'operations') {
                scores.OCTAVE += 3;
            } else if (focus === 'attack') {
                scores.PASTA += 3;
            } else if (focus === 'risk') {
                scores.TRIKE += 3;
                scores.OCTAVE += 1;
                scores.DREDD += 1;
            }
            
            // Phase scoring
            if (phase === 'requirements') {
                scores.TRIKE += 2;
                scores.OCTAVE += 1;
                scores.DREDD += 1;
            } else if (phase === 'design') {
                scores.STRIDE += 3;
                scores.LINDDUN += 3;
                scores.DREDD += 2;
            } else if (phase === 'testing') {
                scores.PASTA += 3;
                scores.DREDD += 1;
            } else if (phase === 'planning') {
                scores.OCTAVE += 3;
            } else if (phase === 'all') {
                scores.CIA += 3;
                scores.DREDD += 1;
            }
            
            // Find the highest score
            let maxScore = 0;
            let recommendedModel = '';
            for (const [model, score] of Object.entries(scores)) {
                if (score > maxScore) {
                    maxScore = score;
                    recommendedModel = model;
                }
            }
            
            // Create recommendation message
            const descriptions = {
                STRIDE: {
                    title: 'STRIDE',
                    desc: 'Best for technical security threat modeling of applications and systems.',
                    why: 'Your requirements indicate a need for comprehensive technical security analysis with moderate complexity.'
                },
                LINDDUN: {
                    title: 'LINDDUN',
                    desc: 'Ideal for privacy-focused threat modeling of data processing systems.',
                    why: 'Your focus on privacy and design phase requirements makes LINDDUN the perfect choice.'
                },
                OCTAVE: {
                    title: 'OCTAVE',
                    desc: 'Perfect for organizational-level risk assessment and strategic planning.',
                    why: 'Your organizational scale and business focus align well with OCTAVE\'s comprehensive approach.'
                },
                PASTA: {
                    title: 'PASTA',
                    desc: 'Excellent for risk-centric attack simulation and testing phases.',
                    why: 'Your focus on attack simulation and testing phase requirements make PASTA highly suitable.'
                },
                CIA: {
                    title: 'CIA Triad',
                    desc: 'Great for foundational security principles across all scenarios.',
                    why: 'Your requirements suggest a need for fundamental security understanding applicable to all contexts.'
                },
                TRIKE: {
                    title: 'TRIKE',
                    desc: 'Suitable for risk management integration in requirements phase.',
                    why: 'Your risk management focus and requirements phase needs align with TRIKE\'s strengths.'
                },
                DREDD: {
                    title: 'DREDD',
                    desc: 'Specialized for data-centric risk evaluation and protection in complex data environments.',
                    why: 'Your focus on data-intensive systems and need for data flow security aligns perfectly with DREDD\'s data-centric approach.'
                }
            };
            
            const chosen = descriptions[recommendedModel];
            
            let recommendation = `
                <h4>${chosen.title}</h4>
                <p><strong>Description:</strong> ${chosen.desc}</p>
                <p><strong>Why this fits:</strong> ${chosen.why}</p>
                <p style="margin-top: 15px;"><strong>Alternative options to consider:</strong></p>
                <div style="margin-left: 20px; margin-top: 10px;">
            `;
            
            // Add alternative recommendations
            const sortedScores = Object.entries(scores).sort((a, b) => b[1] - a[1]).slice(1, 3);
            for (const [model, score] of sortedScores) {
                if (score > 0) {
                    recommendation += `<p><strong>${model}:</strong> ${descriptions[model].desc}</p>`;
                }
            }
            
            recommendation += `
                </div>
                <p style="margin-top: 15px; font-style: italic;">
                    <strong>Next steps:</strong> Click on the "${chosen.title}" tab above to view the detailed RACI matrix and implementation guidance.
                </p>
            `;
            
            // Show result
            document.getElementById('recommendation').innerHTML = recommendation;
            document.getElementById('result').style.display = 'block';
            
            // Scroll to result
            document.getElementById('result').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // Export functions with improved CSV structure
        function exportToCSV() {
            const data = [];
            const timestamp = new Date().toISOString().split('T')[0];
            
            // Add header information
            data.push(['# Threat Model RACI Matrix Export']);
            data.push(['# Generated on:', timestamp]);
            data.push(['# Exported by: Threat Model Selector Application']);
            data.push(['# Author: TheContractor - https://www.linkedin.com/in/thecontractor/']);
            data.push(['']);
            data.push(['']);
            
            // Get all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabContents.forEach((tab, tabIndex) => {
                if (tab.id === 'overview') return; // Skip overview
                
                // Get methodology name
                const methodName = tab.querySelector('h2').textContent;
                data.push([`## ${methodName}`]);
                data.push(['']);
                
                // Get citation info
                const citation = tab.querySelector('.citation');
                if (citation) {
                    const citationText = citation.querySelector('p').textContent;
                    data.push(['### Citation:']);
                    data.push([citationText]);
                    data.push(['']);
                    
                    // Add URLs
                    const urls = tab.querySelectorAll('.citation a');
                    if (urls.length > 0) {
                        data.push(['### URLs:']);
                        urls.forEach(url => {
                            data.push([url.textContent, url.href]);
                        });
                        data.push(['']);
                    }
                }
                
                // Get "Best for" information
                const bestFor = tab.querySelector('.content-section');
                if (bestFor) {
                    data.push(['### Best for:']);
                    const listItems = bestFor.querySelectorAll('li');
                    listItems.forEach(item => {
                        data.push([item.textContent]);
                    });
                    data.push(['']);
                }
                
                // Get RACI matrix
                const table = tab.querySelector('table');
                if (table) {
                    data.push(['### RACI Matrix:']);
                    
                    // Headers
                    const headers = Array.from(table.querySelectorAll('th')).map(th => th.textContent);
                    data.push(headers);
                    
                    // Rows
                    const rows = table.querySelectorAll('tbody tr');
                    rows.forEach(row => {
                        const cells = Array.from(row.querySelectorAll('td')).map(td => td.textContent);
                        data.push(cells);
                    });
                    data.push(['']);
                }
                
                data.push(['']);
                data.push(['------------------------']);
                data.push(['']);
            });
            
            // Add selection criteria summary
            const selectionTab = document.getElementById('selection');
            const selectionTable = selectionTab.querySelector('table');
            if (selectionTable) {
                data.push(['## Selection Criteria Summary']);
                data.push(['']);
                
                // Headers
                const headers = Array.from(selectionTable.querySelectorAll('th')).map(th => th.textContent);
                data.push(headers);
                
                // Rows
                const rows = selectionTable.querySelectorAll('tbody tr');
                rows.forEach(row => {
                    const cells = Array.from(row.querySelectorAll('td')).map(td => td.textContent);
                    data.push(cells);
                });
            }
            
            // Convert to CSV
            const csv = data.map(row => {
                if (row.length === 1 && row[0].startsWith('#')) {
                    return row[0]; // Keep comments as-is
                }
                return row.map(cell => {
                    // Escape quotes and wrap in quotes if necessary
                    const escaped = cell.replace(/"/g, '""');
                    return escaped.includes(',') || escaped.includes('\n') || escaped.includes('"') 
                        ? `"${escaped}"` 
                        : escaped;
                }).join(',');
            }).join('\n');
            
            downloadFile(csv, `threat-model-raci-${timestamp}.csv`, 'text/csv');
        }

        function exportToMarkdown() {
            const tabContents = document.querySelectorAll('.tab-content');
            let markdown = '# Threat Model Selector & RACI Matrix\n\n';
            markdown += `*Exported on: ${new Date().toLocaleDateString()}*\n\n`;
            markdown += `*Author: [TheContractor](https://www.linkedin.com/in/thecontractor/)*\n\n`;
            markdown += '---\n\n';
            
            tabContents.forEach(tab => {
                if (tab.id === 'overview') return; // Skip overview
                
                const title = tab.querySelector('h2');
                if (title) {
                    markdown += `## ${title.textContent}\n\n`;
                    
                    // Add citation
                    const citation = tab.querySelector('.citation');
                    if (citation) {
                        const citationTitle = citation.querySelector('h4');
                        const citationText = citation.querySelector('p');
                        if (citationTitle && citationText) {
                            markdown += `### ${citationTitle.textContent}\n\n`;
                            markdown += `${citationText.textContent}\n\n`;
                        }
                        
                        // Add URLs
                        const urls = tab.querySelectorAll('.citation a');
                        if (urls.length > 0) {
                            markdown += '**URLs:**\n';
                            urls.forEach(url => {
                                markdown += `- [${url.textContent}](${url.href})\n`;
                            });
                            markdown += '\n';
                        }
                    }
                    
                    // Add sections
                    const sections = tab.querySelectorAll('.content-section');
                    sections.forEach(section => {
                        const sectionTitle = section.querySelector('h3');
                        if (sectionTitle) {
                            markdown += `### ${sectionTitle.textContent}\n\n`;
                            const items = section.querySelectorAll('li, p');
                            items.forEach(item => {
                                if (item.tagName === 'LI') {
                                    markdown += `- ${item.textContent}\n`;
                                } else if (item.tagName === 'P') {
                                    markdown += `${item.textContent}\n\n`;
                                }
                            });
                            markdown += '\n';
                        }
                    });
                    
                    // Add table
                    const table = tab.querySelector('table');
                    if (table) {
                        const headers = Array.from(table.querySelectorAll('th')).map(th => th.textContent);
                        markdown += `| ${headers.join(' | ')} |\n`;
                        markdown += `| ${headers.map(() => '---').join(' | ')} |\n`;
                        
                        const rows = table.querySelectorAll('tbody tr');
                        rows.forEach(row => {
                            const cells = Array.from(row.querySelectorAll('td')).map(td => td.textContent.trim() || ' ');
                            markdown += `| ${cells.join(' | ')} |\n`;
                        });
                        markdown += '\n';
                    }
                    
                    markdown += '---\n\n';
                }
            });
            
            downloadFile(markdown, 'threat-model-raci.md', 'text/markdown');
        }

        function downloadFile(content, fileName, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
        }
        
        // Scroll animation for header
        window.addEventListener('scroll', function() {
            const scrollPosition = window.scrollY;
            const header = document.querySelector('header');
            const titleWords = document.querySelectorAll('.title-word');
            const subtitle = document.querySelector('.subtitle');
            const maxScroll = 300; // The scroll position where the animation completes
            
            if (scrollPosition <= maxScroll) {
                // Calculate how far through the animation we are (0 to 1)
                const scrollProgress = scrollPosition / maxScroll;
                
                // Scale down the title words as you scroll
                titleWords.forEach((word, index) => {
                    const delay = index * 0.1; // Stagger the animation for each word
                    const scale = 1 - (scrollProgress * 0.5); // Scale from 1 to 0.5
                    const translateY = scrollProgress * -50; // Move up as you scroll
                    const opacity = 1 - (scrollProgress * 0.5); // Fade slightly
                    word.style.transform = `scale(${scale}) translateY(${translateY}px)`;
                    word.style.opacity = opacity;
                });
                
                // Fade out subtitle
                subtitle.style.opacity = 1 - scrollProgress;
                
                // Reduce header height
                const initialHeight = 300; // Should match min-height in CSS
                const finalHeight = 180;
                const newHeight = initialHeight - ((initialHeight - finalHeight) * scrollProgress);
                header.style.minHeight = `${newHeight}px`;
                header.style.paddingTop = `${40 - (scrollProgress * 15)}px`;
            }
        });
        
        // Tab functionality for both tab systems
        function openTab(evt, tabName) {
            // Get the parent tab container
            const tabContainer = evt.currentTarget.closest('.tab-container');
            
            // Get all tab contents within this container
            const tabcontent = tabContainer.querySelectorAll(".tab-content-base");
            for (let i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.remove("active");
            }
            
            // Get all tab buttons within this container's header
            const tabheader = tabContainer.querySelector('.tab-header');
            const tabbuttons = tabheader.querySelectorAll(".tab-base");
            for (let i = 0; i < tabbuttons.length; i++) {
                tabbuttons[i].classList.remove("active");
            }
            
            // Activate the selected tab
            document.getElementById(tabName).classList.add("active");
            evt.currentTarget.classList.add("active");
        }
        
        // For backward compatibility
        function openIntroTab(evt, tabName) {
            openTab(evt, tabName);
        }
        
        // Initialize tabs and expandable sections on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Make sure all tab systems are properly initialized
            document.querySelectorAll('.tab-header .tab-base.active').forEach(tab => {
                tab.click();
            });
            
            // Make sure the "Who might need this" section stays expanded
            document.getElementById('how-to-use-content').classList.add('active');
            document.querySelector('[onclick="toggleExpandable(\'how-to-use-content\')"]').classList.add('active');
        });
        
        // Toggle expandable sections
        function toggleExpandable(contentId) {
            const content = document.getElementById(contentId);
            const allExpandables = document.querySelectorAll('.expandable-content');
            const clickedLink = document.querySelector(`[onclick="toggleExpandable('${contentId}')"]`);
            
            // Close all expandable sections first
            allExpandables.forEach(section => {
                if (section.id !== contentId) {
                    section.classList.remove('active');
                    
                    // Reset all other links
                    const link = document.querySelector(`[onclick="toggleExpandable('${section.id}')"]`);
                    if (link) link.classList.remove('active');
                }
            });
            
            // Toggle clicked section
            content.classList.toggle('active');
            clickedLink.classList.toggle('active');
        }
        
        // Share functionality
        function shareThis() {
            if (navigator.share) {
                // Web Share API is supported
                navigator.share({
                    title: 'Threat Model Selector & RACI Matrix',
                    text: 'Find the right threat modeling methodology for your needs',
                    url: window.location.href
                })
                .catch(error => {
                    console.error('Error sharing:', error);
                    fallbackShare();
                });
            } else {
                fallbackShare();
            }
        }
        
        function fallbackShare() {
            // Fallback for browsers that don't support Web Share API
            const url = window.location.href;
            const tempInput = document.createElement('input');
            document.body.appendChild(tempInput);
            tempInput.value = url;
            tempInput.select();
            document.execCommand('copy');
            document.body.removeChild(tempInput);
            
            alert('URL copied to clipboard!');
        }
    </script>
    
    <div class="container">
        <div class="document-actions">
            <button class="action-btn" onclick="exportToCSV()" title="Export to CSV">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                Export CSV
            </button>
            
            <button class="action-btn" onclick="exportToMarkdown()" title="Export to Markdown">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                    <polyline points="10 9 9 9 8 9"></polyline>
                </svg>
                Export MD
            </button>
            
            <button class="action-btn" onclick="window.print()" title="Print Page">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="6 9 6 2 18 2 18 9"></polyline>
                    <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                    <rect x="6" y="14" width="12" height="8"></rect>
                </svg>
                Print
            </button>
            
            <button class="action-btn" onclick="shareThis()" title="Share This Page">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="18" cy="5" r="3"></circle>
                    <circle cx="6" cy="12" r="3"></circle>
                    <circle cx="18" cy="19" r="3"></circle>
                    <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                    <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                </svg>
                Share
            </button>
        </div>
    </div>
    
    <div class="print-footer">
        Threat Model Selector & RACI Matrix | Author: TheContractor | https://www.linkedin.com/in/thecontractor/
    </div>
</body>
</html>
