<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Threat Model Selector & RACI Matrix</title>
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Dark mode defaults */
            --bg-color: #121212;
            --surface-1: #1E1E1E;
            --surface-2: #272727;
            --text-primary: #E0E0E0;
            --text-secondary: #BBBBBB;
            --accent-primary: #4D94FF;
            --accent-secondary: #6B8CFF;
            --accent-hover: #638FE8;
            --border-color: #333333;
            --header-bg: #0A0F1C;
            --success: #4CAF50;
            --warning: #FF9800;
            --error: #F44336;
        }

        [data-theme="light"] {
            --bg-color: #ffffff;
            --surface-1: #f8f9fa;
            --surface-2: #e9ecef;
            --text-primary: #212529;
            --text-secondary: #6c757d;
            --accent-primary: #0066CC;
            --accent-secondary: #4285F4;
            --accent-hover: #0052A3;
            --border-color: #dee2e6;
            --header-bg: #1e3c72;
            --success: #28a745;
            --warning: #fd7e14;
            --error: #dc3545;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            line-height: 1.65;
            transition: all 0.3s ease;
        }

        [data-theme="dark"] body {
            font-weight: 350;
        }

        [data-theme="light"] body {
            font-weight: 400;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            background: var(--header-bg);
            color: var(--text-primary);
            text-align: center;
            padding: 40px 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            position: relative;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
            color: white;
        }

        [data-theme="dark"] h1 {
            font-weight: 600;
        }

        header p {
            font-size: 1.1em;
            opacity: 0.9;
            color: #e0e0e0;
        }

        /* Theme Toggle */
        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
        }

        .theme-toggle .icon {
            width: 24px;
            height: 24px;
            stroke: var(--text-primary);
            fill: none;
            stroke-width: 2;
            transition: transform 0.3s ease;
        }

        .theme-toggle:hover .icon {
            transform: scale(1.1);
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            height: 8px;
            background-color: var(--surface-2);
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--accent-primary);
            border-radius: 4px;
            width: 0%;
            transition: width 0.3s ease-in-out;
        }

        /* Selector Section */
        .selector-section {
            background: var(--surface-1);
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            border: 1px solid var(--border-color);
        }

        .selector-section h2 {
            color: var(--accent-primary);
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        [data-theme="dark"] .selector-section h2 {
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s ease;
            background-color: var(--bg-color);
            color: var(--text-primary);
        }

        select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(77, 148, 255, 0.1);
        }

        .btn {
            background: var(--accent-primary);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-right: 10px;
        }

        .btn:hover {
            background: var(--accent-hover);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(77, 148, 255, 0.3);
        }

        .btn-secondary {
            background: var(--text-secondary);
        }

        /* Result Section */
        .result-section {
            background: var(--surface-1);
            border-radius: 10px;
            padding: 30px;
            margin-top: 30px;
            display: none;
            border: 1px solid var(--success);
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.1);
        }

        .result-section h3 {
            color: var(--success);
            margin-bottom: 15px;
        }

        .recommendation-box {
            background: var(--bg-color);
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
            border: 1px solid var(--border-color);
        }

        /* Tabs Section */
        .tabs-section {
            margin-top: 50px;
        }

        .tabs-header {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: -2px;
            border-bottom: 2px solid var(--border-color);
            background: var(--surface-1);
            border-radius: 10px 10px 0 0;
            overflow-x: auto;
        }

        .tab-button {
            background: none;
            border: none;
            padding: 15px 25px;
            font-size: 16px;
            color: var(--text-secondary);
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            font-weight: 500;
            white-space: nowrap;
        }

        .tab-button.active {
            color: var(--accent-primary);
            border-bottom-color: var(--accent-primary);
            background: linear-gradient(to bottom, transparent, rgba(77, 148, 255, 0.05));
        }

        .tab-content {
            display: none;
            padding: 30px;
            background: var(--surface-1);
            border-radius: 0 0 10px 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            border: 1px solid var(--border-color);
            border-top: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Table Styles */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        th {
            background: var(--header-bg);
            color: white;
            padding: 15px 12px;
            font-weight: 600;
            text-align: left;
        }

        td {
            padding: 12px;
            border: 1px solid var(--border-color);
            background: var(--bg-color);
        }

        tr:nth-child(even) td {
            background: var(--surface-1);
        }

        tr:hover td {
            background: var(--surface-2);
        }

        /* Content Sections */
        .content-section {
            margin-bottom: 35px;
        }

        .content-section h3 {
            color: var(--accent-primary);
            margin-bottom: 15px;
            font-size: 1.4em;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 8px;
        }

        [data-theme="dark"] .content-section h3 {
            font-weight: 600;
        }

        .content-section ul {
            padding-left: 25px;
            margin-bottom: 15px;
        }

        .content-section li {
            margin-bottom: 8px;
        }

        /* Export Section */
        .export-section {
            margin-top: 30px;
            padding: 20px;
            background: var(--surface-1);
            border-radius: 8px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .export-section h3 {
            margin-bottom: 15px;
            color: var(--accent-primary);
        }

        /* Citation Styling */
        .citation {
            background: var(--surface-2);
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 4px solid var(--accent-primary);
        }

        .citation h4 {
            color: var(--accent-primary);
            margin-bottom: 8px;
        }

        .citation p {
            margin-bottom: 5px;
        }

        .citation ul {
            list-style: none;
            padding-left: 10px;
        }

        .citation a {
            color: var(--accent-secondary);
            text-decoration: none;
        }

        .citation a:hover {
            text-decoration: underline;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            h1 {
                font-size: 2em;
            }

            .tab-button {
                padding: 12px 15px;
                font-size: 14px;
            }

            table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
        }

        /* Print Styles */
        @media print {
            body {
                background: white;
                color: black;
            }

            .selector-section,
            .export-section,
            .btn,
            .theme-toggle {
                display: none;
            }

            .tabs-header {
                display: none;
            }

            .tab-content {
                display: block !important;
                page-break-after: always;
                background: white;
                color: black;
            }

            .tab-content:last-child {
                page-break-after: avoid;
            }

            table {
                box-shadow: none;
            }

            th {
                background: #f0f0f0;
                color: black;
            }

            td {
                background: white;
                color: black;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle dark/light mode">
                <svg class="icon" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
                    <path id="moon-icon" d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                    <circle id="sun-icon" cx="12" cy="12" r="5" style="display: none;"/>
                    <path id="sun-rays" d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" style="display: none;"/>
                </svg>
            </button>
            <h1>Threat Model Selector & RACI Matrix</h1>
            <p>Find the right threat modeling methodology for your needs and access comprehensive RACI charts</p>
        </header>

        <div class="selector-section">
            <h2>What Threat Model Should You Use?</h2>
            <p>Answer a few quick questions to find the most appropriate threat modeling methodology for your needs.</p>
            
            <!-- Threat Modeling Tool Analogy Section -->
            <div style="background: var(--surface-2); border-left: 4px solid var(--accent-primary); padding: 20px; margin: 20px 0; border-radius: 8px;">
                <h3 style="color: var(--accent-primary); margin-bottom: 10px;">Why Use More Than Just CIA?</h3>
                <p style="margin-bottom: 15px;">While CIA (Confidentiality, Integrity, Availability) is fundamental and widely used, relying solely on it is like having only a flathead screwdriver in your toolbox. It's not that the flathead is bad—it's essential! But sometimes you need a Phillips head, a Torq, or a hex key.</p>
                
                <p style="margin-bottom: 15px;">Each threat modeling methodology serves as a different tool in your security toolkit:</p>
                
                <ul style="margin-left: 20px; margin-bottom: 15px;">
                    <li><strong>CIA</strong> is your basic flathead—universally applicable, simple, and great for foundational understanding</li>
                    <li><strong>STRIDE</strong> is your Phillips head—precise for technical systems with clear attack vectors</li>
                    <li><strong>LINDDUN</strong> is your specialized privacy tool—perfect for data protection scenarios</li>
                    <li><strong>PASTA</strong> is your precision torque tool—ideal for attack simulation and risk quantification</li>
                    <li><strong>OCTAVE</strong> is your heavy-duty wrench—built for organizational-level risk management</li>
                    <li><strong>TRIKE</strong> is your adjustable tool—flexible for risk framework integration</li>
                </ul>
                
                <p style="font-style: italic;">The right tool for the right job makes all the difference. Let's find yours!</p>
            </div>
            
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            
            <form id="threatModelSelector">
                <div class="form-group">
                    <label for="scale">1. What is your project/organization scale?</label>
                    <select id="scale" onchange="updateProgress()">
                        <option value="">Select scale...</option>
                        <option value="component">Component/Single Application</option>
                        <option value="system">Full System</option>
                        <option value="organization">Organization-wide</option>
                        <option value="all">All levels</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="expertise">2. What's your team's security expertise level?</label>
                    <select id="expertise" onchange="updateProgress()">
                        <option value="">Select expertise level...</option>
                        <option value="general">General/Beginner</option>
                        <option value="technical">Technical</option>
                        <option value="privacy">Privacy-focused</option>
                        <option value="business">Business-oriented</option>
                        <option value="security">Advanced Security</option>
                        <option value="risk">Risk Management</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="time">3. How much time can you invest?</label>
                    <select id="time" onchange="updateProgress()">
                        <option value="">Select time investment...</option>
                        <option value="low">Low (Quick assessment)</option>
                        <option value="medium">Medium (Moderate effort)</option>
                        <option value="high">High (Comprehensive analysis)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="focus">4. What's your primary focus area?</label>
                    <select id="focus" onchange="updateProgress()">
                        <option value="">Select focus area...</option>
                        <option value="fundamentals">Security Fundamentals</option>
                        <option value="security">Technical Security</option>
                        <option value="privacy">Privacy Protection</option>
                        <option value="operations">Operations & Business</option>
                        <option value="attack">Attack Simulation</option>
                        <option value="risk">Risk Management</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="phase">5. At what phase are you in development?</label>
                    <select id="phase" onchange="updateProgress()">
                        <option value="">Select phase...</option>
                        <option value="requirements">Requirements Gathering</option>
                        <option value="design">Design Phase</option>
                        <option value="testing">Testing Phase</option>
                        <option value="planning">Strategic Planning</option>
                        <option value="all">All Phases</option>
                    </select>
                </div>
                
                <button type="button" onclick="findThreatModel()" class="btn">Get Recommendation</button>
            </form>
            
            <div id="result" class="result-section">
                <h3>Recommended Threat Model:</h3>
                <div id="recommendation" class="recommendation-box"></div>
            </div>
        </div>

        <div class="tabs-section">
            <div class="tabs-header">
                <button class="tab-button active" onclick="openTab(event, 'overview')">Overview</button>
                <button class="tab-button" onclick="openTab(event, 'stride')">STRIDE</button>
                <button class="tab-button" onclick="openTab(event, 'linddun')">LINDDUN</button>
                <button class="tab-button" onclick="openTab(event, 'octave')">OCTAVE</button>
                <button class="tab-button" onclick="openTab(event, 'pasta')">PASTA</button>
                <button class="tab-button" onclick="openTab(event, 'cia')">CIA Triad</button>
                <button class="tab-button" onclick="openTab(event, 'trike')">TRIKE</button>
                <button class="tab-button" onclick="openTab(event, 'selection')">Selection Guide</button>
            </div>

            <div id="overview" class="tab-content active">
                <h2>Threat Modeling Methodologies Overview</h2>
                <p>This comprehensive guide provides detailed RACI (Responsible, Accountable, Consulted, Informed) matrices for six major threat modeling methodologies. Each methodology has unique strengths and is suited for different organizational contexts, security requirements, and project phases.</p>
                
                <div class="content-section">
                    <h3>Available Methodologies</h3>
                    <ul>
                        <li><strong>STRIDE:</strong> Microsoft's comprehensive security threat modeling framework</li>
                        <li><strong>LINDDUN:</strong> Privacy-focused threat modeling methodology</li>
                        <li><strong>OCTAVE:</strong> Organizational-level risk assessment framework</li>
                        <li><strong>PASTA:</strong> Process for Attack Simulation and Threat Analysis</li>
                        <li><strong>CIA Triad:</strong> Fundamental information security principles</li>
                        <li><strong>TRIKE:</strong> Risk management-focused threat modeling approach</li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>How to Use This Guide</h3>
                    <ol>
                        <li>Start with the "What Threat Model Should You Use?" selector above</li>
                        <li>Review the recommended methodology details in the corresponding tab</li>
                        <li>Examine the RACI matrix to understand role assignments</li>
                        <li>Check the selection guide for detailed comparisons</li>
                        <li>Export or print the information for your team</li>
                    </ol>
                </div>
            </div>

            <div id="stride" class="tab-content">
                <h2>STRIDE Threat Modeling</h2>
                
                <div class="citation">
                    <h4>Citation</h4>
                    <p>Developed by Microsoft in the late 1990s by Praerit Garg and Loren Kohnfelder. Microsoft Security Development Lifecycle (SDL).</p>
                    <h4>URLs:</h4>
                    <ul>
                        <li><a href="https://learn.microsoft.com/en-us/azure/security/develop/threat-modeling-tool" target="_blank">Microsoft Threat Modeling Tool</a></li>
                        <li><a href="https://www.microsoft.com/en-us/securityengineering/sdl/threatmodeling" target="_blank">SDL Threat Modeling Process</a></li>
                        <li><a href="https://learn.microsoft.com/en-us/azure/security/develop/threat-modeling-tool-getting-started" target="_blank">Threat Modeling Tool Overview</a></li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>Best for:</h3>
                    <ul>
                        <li><strong>Timing:</strong> Early design phases and throughout development</li>
                        <li><strong>Context:</strong> Complex systems with multiple components and trust boundaries</li>
                        <li><strong>Focus:</strong> Comprehensive security threat identification</li>
                        <li><strong>Organizations:</strong> Development teams and system integrators</li>
                        <li><strong>Use cases:</strong> Software applications, distributed systems, cloud architectures</li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>STRIDE RACI Matrix</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Role/Group</th>
                                <th>Responsible</th>
                                <th>Accountable</th>
                                <th>Consulted</th>
                                <th>Informed</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Project Manager</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Security Officer</td>
                                <td>X</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>System Architect</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Development Team Lead</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Network Administrator</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Cloud/DevOps Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Software Developers</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Governance Board</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                            <tr>
                                <td>Business Stakeholders</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                            <tr>
                                <td>Suppliers/Vendors</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Legal/Compliance Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="linddun" class="tab-content">
                <h2>LINDDUN Threat Modeling</h2>
                
                <div class="citation">
                    <h4>Citation</h4>
                    <p>Developed by KU Leuven researchers Kim Wuyts, Riccardo Scandariato, Wouter Joosen (2015). "LINDDUN Privacy Threat Trees: A Systematic Methodology for Privacy Risk Management."</p>
                    <h4>URLs:</h4>
                    <ul>
                        <li><a href="https://linddun.org/" target="_blank">Official LINDDUN Framework</a></li>
                        <li><a href="https://www.nist.gov/privacy-framework/linddun-privacy-threat-modeling-framework" target="_blank">NIST Privacy Framework</a></li>
                        <li><a href="https://www.cs.kuleuven.be/~distrinet/" target="_blank">KU Leuven DistriNet Research</a></li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>Best for:</h3>
                    <ul>
                        <li><strong>Timing:</strong> Early design phase and privacy impact assessments</li>
                        <li><strong>Context:</strong> Systems processing personal data</li>
                        <li><strong>Focus:</strong> Privacy-specific threats and data protection</li>
                        <li><strong>Organizations:</strong> GDPR-compliant entities, healthcare, finance</li>
                        <li><strong>Use cases:</strong> Personal data systems, IoT devices, mobile applications</li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>LINDDUN RACI Matrix</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Role/Group</th>
                                <th>Responsible</th>
                                <th>Accountable</th>
                                <th>Consulted</th>
                                <th>Informed</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Privacy Officer</td>
                                <td>X</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Data Protection Officer</td>
                                <td>X</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Security Analyst</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Legal Counsel</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Business Process Owner</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Data Engineering Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>UX/Product Team</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Compliance Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Management Board</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                            <tr>
                                <td>Data Subjects Representatives</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Third-party Processors</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="octave" class="tab-content">
                <h2>OCTAVE Threat Modeling</h2>
                
                <div class="citation">
                    <h4>Citation</h4>
                    <p>Developed by Carnegie Mellon University's Software Engineering Institute (SEI) and CERT Coordination Center. First introduced in 1999 by Christopher Alberts and Audrey Dorofee.</p>
                    <h4>URLs:</h4>
                    <ul>
                        <li><a href="https://insights.sei.cmu.edu/library/operationally-critical-threat-asset-and-vulnerability-evaluation-octave-framework-version-10/" target="_blank">SEI OCTAVE Overview</a></li>
                        <li><a href="https://resources.sei.cmu.edu/library/asset-view.cfm?assetid=8419" target="_blank">OCTAVE Allegro</a></li>
                        <li><a href="https://insights.sei.cmu.edu/blog/threat-modeling-12-available-methods/" target="_blank">SEI Threat Modeling Resources</a></li>
                        <li><a href="https://resources.sei.cmu.edu/library/asset-view.cfm?assetid=309051" target="_blank">OCTAVE Related Assets</a></li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>Best for:</h3>
                    <ul>
                        <li><strong>Timing:</strong> Organizational risk assessment cycles</li>
                        <li><strong>Context:</strong> Large organizations needing self-directed assessments</li>
                        <li><strong>Focus:</strong> Operational risk management and organizational assets</li>
                        <li><strong>Organizations:</strong> Enterprises with established risk management programs</li>
                        <li><strong>Use cases:</strong> Critical infrastructure, organizational security planning</li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>OCTAVE RACI Matrix</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Role/Group</th>
                                <th>Responsible</th>
                                <th>Accountable</th>
                                <th>Consulted</th>
                                <th>Informed</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>OCTAVE Team Lead</td>
                                <td>X</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Business Unit Managers</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>IT Operations Manager</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Risk Management Team</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Asset Owners</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Information Security Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>External Consultants</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Executive Sponsor</td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Legal/Audit Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Business Stakeholders</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                            <tr>
                                <td>Board of Directors</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="pasta" class="tab-content">
                <h2>PASTA Threat Modeling</h2>
                
                <div class="citation">
                    <h4>Citation</h4>
                    <p>Developed by Tony UcedaVelez and Marco M. Morana. Published in "Risk Centric Threat Modeling: Process for Attack Simulation and Threat Analysis" (2015).</p>
                    <h4>URLs:</h4>
                    <ul>
                        <li><a href="https://versprite.com/cybersecurity-listings/offsec/pasta-threat-modeling/" target="_blank">VerSprite PASTA Methodology</a></li>
                        <li><a href="https://threat-modeling.com/pasta-threat-modeling/" target="_blank">PASTA Framework Guide</a></li>
                        <li><a href="https://www.iriusrisk.com/resources-blog/pasta-threat-modeling-methodologies" target="_blank">PASTA Threat Modeling Overview</a></li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>Best for:</h3>
                    <ul>
                        <li><strong>Timing:</strong> During security architecture and testing phases</li>
                        <li><strong>Context:</strong> Systems requiring quantitative risk assessment</li>
                        <li><strong>Focus:</strong> Attack simulation and risk-based security testing</li>
                        <li><strong>Organizations:</strong> Security-focused teams with attack modeling expertise</li>
                        <li><strong>Use cases:</strong> High-risk applications, financial systems, critical infrastructure</li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>PASTA RACI Matrix</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Role/Group</th>
                                <th>Responsible</th>
                                <th>Accountable</th>
                                <th>Consulted</th>
                                <th>Informed</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Threat Analyst</td>
                                <td>X</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Attack Simulation Team</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Risk Assessment Team</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Security Architect</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Red Team/Penetration Testers</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Quantitative Risk Analysts</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Business Impact Analysts</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Management Team</td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Development Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Incident Response Team</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                            <tr>
                                <td>Stakeholders</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="cia" class="tab-content">
                <h2>CIA Triad</h2>
                
                <div class="citation">
                    <h4>Citation</h4>
                    <p>Fundamental information security model attributed to multiple sources, formally described by Jerome Saltzer and Michael Schroeder in "The Protection of Information in Computer Systems" (1975). Widely adopted across information security frameworks.</p>
                    <h4>URLs:</h4>
                    <ul>
                        <li><a href="https://csrc.nist.gov/glossary/term/CIA" target="_blank">NIST Cybersecurity Glossary</a></li>
                        <li><a href="https://www.nist.gov/image/cia-triad" target="_blank">NIST CIA Triad Overview</a></li>
                        <li><a href="https://complianceforge.com/free-guides/confidentiality-integrity-availability-security/" target="_blank">ComplianceForge CIA/CIAS Model</a></li>
                        <li><a href="https://csrc.nist.gov/" target="_blank">NIST Cybersecurity Framework Documentation</a></li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>Best for:</h3>
                    <ul>
                        <li><strong>Timing:</strong> Continuous application across all security activities</li>
                        <li><strong>Context:</strong> Foundational security analysis for any system</li>
                        <li><strong>Focus:</strong> Basic security properties assessment</li>
                        <li><strong>Organizations:</strong> All organizations implementing security controls</li>
                        <li><strong>Use cases:</strong> General security planning, security awareness, policy development</li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>CIA Triad RACI Matrix</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Role/Group</th>
                                <th>Responsible</th>
                                <th>Accountable</th>
                                <th>Consulted</th>
                                <th>Informed</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Information Security Manager</td>
                                <td>X</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>System Administrators</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Database Administrators</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Network Security Team</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Data Classification Officer</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Access Control Team</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Business Unit Heads</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Compliance Officer</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Executive Leadership</td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>All Staff</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                            <tr>
                                <td>External Auditors</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="trike" class="tab-content">
                <h2>TRIKE Threat Modeling</h2>
                
                <div class="citation">
                    <h4>Citation</h4>
                    <p>Open source threat modeling methodology developed by Brenda Larcom and Eleanor Saitta. First presented at the Security and Privacy Summit in 2006.</p>
                    <h4>URLs:</h4>
                    <ul>
                        <li><a href="https://trike.sourceforge.net/" target="_blank">Official Trike Project</a></li>
                        <li><a href="https://trike.sourceforge.net/docs.shtml" target="_blank">TRIKE Documentation</a></li>
                        <li><a href="https://trike.sourceforge.net/papers/" target="_blank">TRIKE Papers</a></li>
                        <li><a href="https://www.researchgate.net/publication/229046782_Trike_v_1_Methodology_Document_Draft" target="_blank">TRIKE Methodology Document</a></li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>Best for:</h3>
                    <ul>
                        <li><strong>Timing:</strong> Requirements gathering and risk management phases</li>
                        <li><strong>Context:</strong> Organizations with existing risk frameworks</li>
                        <li><strong>Focus:</strong> Risk management integration with security requirements</li>
                        <li><strong>Organizations:</strong> Mature security programs with risk management integration</li>
                        <li><strong>Use cases:</strong> Enterprise security planning, regulatory compliance</li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>TRIKE RACI Matrix</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Role/Group</th>
                                <th>Responsible</th>
                                <th>Accountable</th>
                                <th>Consulted</th>
                                <th>Informed</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Risk Management Lead</td>
                                <td>X</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Security Analysts</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Business Analysts</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Asset Managers</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Threat Modelers</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>System Architects</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Security Requirements Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Executive Sponsor</td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Audit Team</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Project Management Office</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                            <tr>
                                <td>Development Teams</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="selection" class="tab-content">
                <h2>Selection Criteria Summary</h2>
                
                <div class="content-section">
                    <table>
                        <thead>
                            <tr>
                                <th>Criteria</th>
                                <th>STRIDE</th>
                                <th>LINDDUN</th>
                                <th>OCTAVE</th>
                                <th>PASTA</th>
                                <th>CIA</th>
                                <th>TRIKE</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Complexity</strong></td>
                                <td>Medium</td>
                                <td>Medium</td>
                                <td>High</td>
                                <td>High</td>
                                <td>Low</td>
                                <td>Medium</td>
                            </tr>
                            <tr>
                                <td><strong>Required Expertise</strong></td>
                                <td>Technical</td>
                                <td>Privacy</td>
                                <td>Business</td>
                                <td>Security</td>
                                <td>General</td>
                                <td>Risk</td>
                            </tr>
                            <tr>
                                <td><strong>Time Investment</strong></td>
                                <td>Medium</td>
                                <td>Medium</td>
                                <td>High</td>
                                <td>High</td>
                                <td>Low</td>
                                <td>Medium</td>
                            </tr>
                            <tr>
                                <td><strong>Focus Area</strong></td>
                                <td>Security</td>
                                <td>Privacy</td>
                                <td>Operations</td>
                                <td>Attack Simulation</td>
                                <td>Fundamentals</td>
                                <td>Risk Management</td>
                            </tr>
                            <tr>
                                <td><strong>Best Phase</strong></td>
                                <td>Design</td>
                                <td>Design</td>
                                <td>Planning</td>
                                <td>Testing</td>
                                <td>All</td>
                                <td>Requirements</td>
                            </tr>
                            <tr>
                                <td><strong>Scale</strong></td>
                                <td>Component-System</td>
                                <td>System</td>
                                <td>Organization</td>
                                <td>System</td>
                                <td>All</td>
                                <td>Enterprise</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="content-section">
                    <h3>Key Recommendations</h3>
                    <ol>
                        <li><strong>Start with CIA</strong> for foundational understanding</li>
                        <li><strong>Use STRIDE</strong> for technical system threat modeling</li>
                        <li><strong>Apply LINDDUN</strong> when privacy is critical</li>
                        <li><strong>Consider PASTA</strong> for attack-centric analysis</li>
                        <li><strong>Implement OCTAVE</strong> for organizational-level assessment</li>
                        <li><strong>Use TRIKE</strong> when integrating with existing risk frameworks</li>
                    </ol>
                    
                    <p><strong>Remember:</strong> These models can be combined based on organizational needs. Many teams use a hybrid approach, starting with CIA/STRIDE and adding privacy-focused LINDDUN or risk-focused OCTAVE/TRIKE as needed.</p>
                </div>
            </div>
        </div>

        <div class="export-section">
            <h3>Export Options</h3>
            <p>Save or share this information:</p>
            <button onclick="exportToCSV()" class="btn">Export to CSV</button>
            <button onclick="exportToMarkdown()" class="btn">Export to Markdown</button>
            <button onclick="window.print()" class="btn">Print Page</button>
        </div>
    </div>

    <script>
        // Initialize theme
        let currentTheme = 'dark';
        document.documentElement.setAttribute('data-theme', currentTheme);

        // Theme toggle
        function toggleTheme() {
            currentTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', currentTheme);
            
            const moonIcon = document.getElementById('moon-icon');
            const sunIcon = document.getElementById('sun-icon');
            const sunRays = document.getElementById('sun-rays');
            
            if (currentTheme === 'light') {
                moonIcon.style.display = 'none';
                sunIcon.style.display = 'block';
                sunRays.style.display = 'block';
            } else {
                moonIcon.style.display = 'block';
                sunIcon.style.display = 'none';
                sunRays.style.display = 'none';
            }
        }

        // Progress bar update
        function updateProgress() {
            const selects = ['scale', 'expertise', 'time', 'focus', 'phase'];
            let completed = 0;
            
            selects.forEach(id => {
                if (document.getElementById(id).value) {
                    completed++;
                }
            });
            
            const progress = (completed / selects.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }

        // Tab functionality
        function openTab(evt, tabName) {
            const tabcontent = document.getElementsByClassName("tab-content");
            for (let i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.remove("active");
            }
            
            const tabbuttons = document.getElementsByClassName("tab-button");
            for (let i = 0; i < tabbuttons.length; i++) {
                tabbuttons[i].classList.remove("active");
            }
            
            document.getElementById(tabName).classList.add("active");
            evt.currentTarget.classList.add("active");
        }

        // Threat model selector
        function findThreatModel() {
            const scale = document.getElementById('scale').value;
            const expertise = document.getElementById('expertise').value;
            const time = document.getElementById('time').value;
            const focus = document.getElementById('focus').value;
            const phase = document.getElementById('phase').value;
            
            if (!scale || !expertise || !time || !focus || !phase) {
                alert('Please answer all questions before getting a recommendation.');
                return;
            }
            
            let scores = {
                STRIDE: 0,
                LINDDUN: 0,
                OCTAVE: 0,
                PASTA: 0,
                CIA: 0,
                TRIKE: 0
            };
            
            // Scale scoring
            if (scale === 'component') {
                scores.STRIDE += 3;
                scores.CIA += 2;
                scores.PASTA += 2;
            } else if (scale === 'system') {
                scores.STRIDE += 3;
                scores.LINDDUN += 2;
                scores.PASTA += 3;
            } else if (scale === 'organization') {
                scores.OCTAVE += 3;
                scores.TRIKE += 2;
            } else if (scale === 'all') {
                scores.CIA += 3;
            }
            
            // Expertise scoring
            if (expertise === 'general') {
                scores.CIA += 3;
                scores.STRIDE += 1;
            } else if (expertise === 'technical') {
                scores.STRIDE += 3;
                scores.PASTA += 2;
            } else if (expertise === 'privacy') {
                scores.LINDDUN += 3;
            } else if (expertise === 'business') {
                scores.OCTAVE += 3;
                scores.TRIKE += 2;
            } else if (expertise === 'security') {
                scores.PASTA += 3;
                scores.STRIDE += 2;
            } else if (expertise === 'risk') {
                scores.TRIKE += 3;
                scores.OCTAVE += 2;
            }
            
            // Time scoring
            if (time === 'low') {
                scores.CIA += 3;
                scores.STRIDE += 1;
            } else if (time === 'medium') {
                scores.STRIDE += 2;
                scores.LINDDUN += 2;
                scores.TRIKE += 2;
            } else if (time === 'high') {
                scores.OCTAVE += 3;
                scores.PASTA += 3;
            }
            
            // Focus scoring
            if (focus === 'fundamentals') {
                scores.CIA += 3;
            } else if (focus === 'security') {
                scores.STRIDE += 3;
            } else if (focus === 'privacy') {
                scores.LINDDUN += 3;
            } else if (focus === 'operations') {
                scores.OCTAVE += 3;
            } else if (focus === 'attack') {
                scores.PASTA += 3;
            } else if (focus === 'risk') {
                scores.TRIKE += 3;
                scores.OCTAVE += 1;
            }
            
            // Phase scoring
            if (phase === 'requirements') {
                scores.TRIKE += 2;
                scores.OCTAVE += 1;
            } else if (phase === 'design') {
                scores.STRIDE += 3;
                scores.LINDDUN += 3;
            } else if (phase === 'testing') {
                scores.PASTA += 3;
            } else if (phase === 'planning') {
                scores.OCTAVE += 3;
            } else if (phase === 'all') {
                scores.CIA += 3;
            }
            
            // Find the highest score
            let maxScore = 0;
            let recommendedModel = '';
            for (const [model, score] of Object.entries(scores)) {
                if (score > maxScore) {
                    maxScore = score;
                    recommendedModel = model;
                }
            }
            
            // Create recommendation message
            const descriptions = {
                STRIDE: {
                    title: 'STRIDE',
                    desc: 'Best for technical security threat modeling of applications and systems.',
                    why: 'Your requirements indicate a need for comprehensive technical security analysis with moderate complexity.'
                },
                LINDDUN: {
                    title: 'LINDDUN',
                    desc: 'Ideal for privacy-focused threat modeling of data processing systems.',
                    why: 'Your focus on privacy and design phase requirements makes LINDDUN the perfect choice.'
                },
                OCTAVE: {
                    title: 'OCTAVE',
                    desc: 'Perfect for organizational-level risk assessment and strategic planning.',
                    why: 'Your organizational scale and business focus align well with OCTAVE\'s comprehensive approach.'
                },
                PASTA: {
                    title: 'PASTA',
                    desc: 'Excellent for risk-centric attack simulation and testing phases.',
                    why: 'Your focus on attack simulation and testing phase requirements make PASTA highly suitable.'
                },
                CIA: {
                    title: 'CIA Triad',
                    desc: 'Great for foundational security principles across all scenarios.',
                    why: 'Your requirements suggest a need for fundamental security understanding applicable to all contexts.'
                },
                TRIKE: {
                    title: 'TRIKE',
                    desc: 'Suitable for risk management integration in requirements phase.',
                    why: 'Your risk management focus and requirements phase needs align with TRIKE\'s strengths.'
                }
            };
            
            const chosen = descriptions[recommendedModel];
            
            let recommendation = `
                <h4>${chosen.title}</h4>
                <p><strong>Description:</strong> ${chosen.desc}</p>
                <p><strong>Why this fits:</strong> ${chosen.why}</p>
                <p style="margin-top: 15px;"><strong>Alternative options to consider:</strong></p>
                <ul>
            `;
            
            // Add alternative recommendations
            const sortedScores = Object.entries(scores).sort((a, b) => b[1] - a[1]).slice(1, 3);
            for (const [model, score] of sortedScores) {
                if (score > 0) {
                    recommendation += `<li>${model} - ${descriptions[model].desc}</li>`;
                }
            }
            
            recommendation += `
                </ul>
                <p style="margin-top: 15px; font-style: italic;">
                    <strong>Next steps:</strong> Click on the "${chosen.title}" tab above to view the detailed RACI matrix and implementation guidance.
                </p>
            `;
            
            // Show result
            document.getElementById('recommendation').innerHTML = recommendation;
            document.getElementById('result').style.display = 'block';
            
            // Scroll to result
            document.getElementById('result').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // Export functions with improved CSV structure
        function exportToCSV() {
            const data = [];
            const timestamp = new Date().toISOString().split('T')[0];
            
            // Add header information
            data.push(['# Threat Model RACI Matrix Export']);
            data.push(['# Generated on:', timestamp]);
            data.push(['# Exported by: Threat Model Selector Application']);
            data.push(['']);
            data.push(['']);
            
            // Get all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabContents.forEach((tab, tabIndex) => {
                if (tab.id === 'overview') return; // Skip overview
                
                // Get methodology name
                const methodName = tab.querySelector('h2').textContent;
                data.push([`## ${methodName}`]);
                data.push(['']);
                
                // Get citation info
                const citation = tab.querySelector('.citation');
                if (citation) {
                    const citationText = citation.querySelector('p').textContent;
                    data.push(['### Citation:']);
                    data.push([citationText]);
                    data.push(['']);
                    
                    // Add URLs
                    const urls = tab.querySelectorAll('.citation a');
                    if (urls.length > 0) {
                        data.push(['### URLs:']);
                        urls.forEach(url => {
                            data.push([url.textContent, url.href]);
                        });
                        data.push(['']);
                    }
                }
                
                // Get "Best for" information
                const bestFor = tab.querySelector('.content-section');
                if (bestFor) {
                    data.push(['### Best for:']);
                    const listItems = bestFor.querySelectorAll('li');
                    listItems.forEach(item => {
                        data.push([item.textContent]);
                    });
                    data.push(['']);
                }
                
                // Get RACI matrix
                const table = tab.querySelector('table');
                if (table) {
                    data.push(['### RACI Matrix:']);
                    
                    // Headers
                    const headers = Array.from(table.querySelectorAll('th')).map(th => th.textContent);
                    data.push(headers);
                    
                    // Rows
                    const rows = table.querySelectorAll('tbody tr');
                    rows.forEach(row => {
                        const cells = Array.from(row.querySelectorAll('td')).map(td => td.textContent);
                        data.push(cells);
                    });
                    data.push(['']);
                }
                
                data.push(['']);
                data.push(['------------------------']);
                data.push(['']);
            });
            
            // Add selection criteria summary
            const selectionTab = document.getElementById('selection');
            const selectionTable = selectionTab.querySelector('table');
            if (selectionTable) {
                data.push(['## Selection Criteria Summary']);
                data.push(['']);
                
                // Headers
                const headers = Array.from(selectionTable.querySelectorAll('th')).map(th => th.textContent);
                data.push(headers);
                
                // Rows
                const rows = selectionTable.querySelectorAll('tbody tr');
                rows.forEach(row => {
                    const cells = Array.from(row.querySelectorAll('td')).map(td => td.textContent);
                    data.push(cells);
                });
            }
            
            // Convert to CSV
            const csv = data.map(row => {
                if (row.length === 1 && row[0].startsWith('#')) {
                    return row[0]; // Keep comments as-is
                }
                return row.map(cell => {
                    // Escape quotes and wrap in quotes if necessary
                    const escaped = cell.replace(/"/g, '""');
                    return escaped.includes(',') || escaped.includes('\n') || escaped.includes('"') 
                        ? `"${escaped}"` 
                        : escaped;
                }).join(',');
            }).join('\n');
            
            downloadFile(csv, `threat-model-raci-${timestamp}.csv`, 'text/csv');
        }

        function exportToMarkdown() {
            const tabContents = document.querySelectorAll('.tab-content');
            let markdown = '# Threat Model Selector & RACI Matrix\n\n';
            markdown += `*Exported on: ${new Date().toLocaleDateString()}*\n\n`;
            markdown += '---\n\n';
            
            tabContents.forEach(tab => {
                if (tab.id === 'overview') return; // Skip overview
                
                const title = tab.querySelector('h2');
                if (title) {
                    markdown += `## ${title.textContent}\n\n`;
                    
                    // Add citation
                    const citation = tab.querySelector('.citation');
                    if (citation) {
                        const citationTitle = citation.querySelector('h4');
                        const citationText = citation.querySelector('p');
                        if (citationTitle && citationText) {
                            markdown += `### ${citationTitle.textContent}\n\n`;
                            markdown += `${citationText.textContent}\n\n`;
                        }
                        
                        // Add URLs
                        const urls = tab.querySelectorAll('.citation a');
                        if (urls.length > 0) {
                            markdown += '**URLs:**\n';
                            urls.forEach(url => {
                                markdown += `- [${url.textContent}](${url.href})\n`;
                            });
                            markdown += '\n';
                        }
                    }
                    
                    // Add sections
                    const sections = tab.querySelectorAll('.content-section');
                    sections.forEach(section => {
                        const sectionTitle = section.querySelector('h3');
                        if (sectionTitle) {
                            markdown += `### ${sectionTitle.textContent}\n\n`;
                            const items = section.querySelectorAll('li, p');
                            items.forEach(item => {
                                if (item.tagName === 'LI') {
                                    markdown += `- ${item.textContent}\n`;
                                } else if (item.tagName === 'P') {
                                    markdown += `${item.textContent}\n\n`;
                                }
                            });
                            markdown += '\n';
                        }
                    });
                    
                    // Add table
                    const table = tab.querySelector('table');
                    if (table) {
                        const headers = Array.from(table.querySelectorAll('th')).map(th => th.textContent);
                        markdown += `| ${headers.join(' | ')} |\n`;
                        markdown += `| ${headers.map(() => '---').join(' | ')} |\n`;
                        
                        const rows = table.querySelectorAll('tbody tr');
                        rows.forEach(row => {
                            const cells = Array.from(row.querySelectorAll('td')).map(td => td.textContent.trim() || ' ');
                            markdown += `| ${cells.join(' | ')} |\n`;
                        });
                        markdown += '\n';
                    }
                    
                    markdown += '---\n\n';
                }
            });
            
            downloadFile(markdown, 'threat-model-raci.md', 'text/markdown');
        }

        function downloadFile(content, fileName, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
        }
    </script>
</body>
</html>
